{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/landscape/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.js","path":"fancybox/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/js/script.js","path":"js/script.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/FontAwesome.otf","path":"css/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.eot","path":"css/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.woff","path":"css/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/fancybox_buttons.png","path":"fancybox/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.css","path":"fancybox/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.js","path":"fancybox/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-media.js","path":"fancybox/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.css","path":"fancybox/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.js","path":"fancybox/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.ttf","path":"css/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.svg","path":"css/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/images/banner.jpg","path":"css/images/banner.jpg","modified":0,"renderable":1}],"Cache":[{"_id":"themes/landscape/.gitignore","hash":"ea2b285a29690f1eabbad0f3a158e34e9ccd1d86","modified":1511073850118},{"_id":"themes/landscape/Gruntfile.js","hash":"412e30530784993c8997aa8b1319c669b83b91c2","modified":1511073850120},{"_id":"themes/landscape/LICENSE","hash":"82ce1e15ddeabeaaca60e2186b5a3ce42b1a9c49","modified":1511073850121},{"_id":"themes/landscape/README.md","hash":"e7cc82dc79596f36ba05a8139e7d6b2dfc4ae5f9","modified":1511073850123},{"_id":"themes/landscape/_config.yml","hash":"218c5fb76666696c42dc86e2de4711e6b80befbf","modified":1511073850125},{"_id":"themes/landscape/package.json","hash":"d07f326588fef82f1d23ae3101c9ddfff34c132f","modified":1511073850181},{"_id":"source/_posts/ArrayToList.md","hash":"00c7b002787c7f9a1aa13111b26536dd7a6c1a64","modified":1517782775878},{"_id":"source/_posts/InteractiveMap_01.md","hash":"6a16b2d02124d345dbc12614b701c94434670f99","modified":1518605888443},{"_id":"source/_posts/JavaInstallation.md","hash":"f745fc6b3f793baecdb7ce1944f44fc43915daba","modified":1517782775863},{"_id":"themes/landscape/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1511073850170},{"_id":"themes/landscape/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1511073850172},{"_id":"themes/landscape/layout/index.ejs","hash":"aa1b4456907bdb43e629be3931547e2d29ac58c8","modified":1511073850174},{"_id":"themes/landscape/layout/layout.ejs","hash":"5d86bc48b0f1bdce9a2bb548c2f8e7a4f50d499a","modified":1511073850175},{"_id":"themes/landscape/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1511073850177},{"_id":"themes/landscape/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1511073850179},{"_id":"themes/landscape/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1511073850180},{"_id":"themes/landscape/languages/default.yml","hash":"f26a34a7983d4bc17c65c7f0f14da598e62ce66d","modified":1511073850127},{"_id":"themes/landscape/scripts/fancybox.js","hash":"4c130fc242cf9b59b5df6ca5eae3b14302311e8c","modified":1511073850183},{"_id":"themes/landscape/layout/_partial/after-footer.ejs","hash":"a7faab4f3601b28107af5b1095b3966c2f88fec8","modified":1511073850138},{"_id":"themes/landscape/layout/_partial/archive-post.ejs","hash":"5062c723721d8497eebad372f57092ade45041f4","modified":1511073850139},{"_id":"themes/landscape/layout/_partial/archive.ejs","hash":"3beb0d164acacb6f21e1ca2038158a74ab4a73e4","modified":1511073850141},{"_id":"themes/landscape/layout/_partial/footer.ejs","hash":"1a7f3b46036c02200dd0ac13938a205bc75d77ac","modified":1511074310997},{"_id":"themes/landscape/layout/_partial/article.ejs","hash":"5cf2b8a1148e6f8c4bd9ca9e3b84c7e5a59d56bc","modified":1511073850142},{"_id":"themes/landscape/layout/_partial/google-analytics.ejs","hash":"1ccc627d7697e68fddc367c73ac09920457e5b35","modified":1511073850145},{"_id":"themes/landscape/layout/_partial/head.ejs","hash":"2062416b516da84895e4de20fff6e9fc5158c30b","modified":1511134333747},{"_id":"themes/landscape/layout/_partial/header.ejs","hash":"35b55c32fe56a2a69ac7eca9e1f1582e219b3f80","modified":1511082568355},{"_id":"themes/landscape/layout/_partial/mobile-nav.ejs","hash":"347cf1befd2ea637c24bd5901929d8e36e359e75","modified":1511073850151},{"_id":"themes/landscape/layout/_partial/sidebar.ejs","hash":"c70869569749a8f48cce202fa57926c06b55fdab","modified":1511073850162},{"_id":"themes/landscape/layout/_widget/archive.ejs","hash":"0fe1e52c291c9499bd05b966e0b9aac5be351c58","modified":1511073850164},{"_id":"themes/landscape/layout/_widget/category.ejs","hash":"866790acc13fed44b7ef74c3e19c300a3d6180d8","modified":1511073850165},{"_id":"themes/landscape/layout/_widget/recent_posts.ejs","hash":"16800f85ffb036d2644a26e02facd61acb3706e9","modified":1511073850166},{"_id":"themes/landscape/layout/_widget/tag.ejs","hash":"6017c54a8c3c8ff8db491cfbea3100c139da75d6","modified":1511073850168},{"_id":"themes/landscape/layout/_widget/tagcloud.ejs","hash":"7259c179aa0c41c02e467ad892292e90430aaabc","modified":1511073850169},{"_id":"themes/landscape/source/css/_extend.styl","hash":"8ab1ad313bd6707d248c5ca1ee9a5eab8d815e42","modified":1511073850186},{"_id":"themes/landscape/source/css/_variables.styl","hash":"8b63ea3c7199524b9a1541075c6f8fb2c0d0ea3d","modified":1511073850207},{"_id":"themes/landscape/source/css/style.styl","hash":"4a3e64ee8dad5834860c30b4176882eff628ca6b","modified":1511073850224},{"_id":"themes/landscape/source/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1511073850225},{"_id":"themes/landscape/source/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1511073850227},{"_id":"themes/landscape/source/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1511073850228},{"_id":"themes/landscape/source/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1511073850232},{"_id":"themes/landscape/source/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1511073850230},{"_id":"themes/landscape/source/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1511073850233},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.css","hash":"8f64602354463884b521b2a31145f5df974d69b1","modified":1511946464115},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.js","hash":"58193c802f307ec9bc9e586c0e8a13ebef45d2f8","modified":1511073850245},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.pack.js","hash":"2da892a02778236b64076e5e8802ef0566e1d9e8","modified":1511073850246},{"_id":"themes/landscape/source/js/script.js","hash":"c0d368681c687258b628bacc84cc30d353de6d47","modified":1511073850248},{"_id":"themes/landscape/layout/_partial/post/category.ejs","hash":"16128d2422645e18d1b6882d4c4df17d895bd76e","modified":1511073850152},{"_id":"themes/landscape/layout/_partial/post/date.ejs","hash":"947f513f7a85fbcf085624e46dc2ae6de8185eec","modified":1511073850154},{"_id":"themes/landscape/layout/_partial/post/gallery.ejs","hash":"b0bf3f5d923c261ca2b5fabab513f1ec2708c8ca","modified":1511073850156},{"_id":"themes/landscape/layout/_partial/post/nav.ejs","hash":"cbb3819ce512bd24db8bad41b8617d46eba82fdc","modified":1511073850157},{"_id":"themes/landscape/layout/_partial/post/tag.ejs","hash":"694b5101bcc44c9f9c1cc62e5ad2fdfb4b7c7a07","modified":1511073850159},{"_id":"themes/landscape/layout/_partial/post/title.ejs","hash":"d4a460a35e2112d0c7414fd5e19b3a16093f1caf","modified":1511073850160},{"_id":"themes/landscape/source/css/_partial/archive.styl","hash":"b16338de12044b9b6511ad4c80806d6d1ff23c22","modified":1517783072501},{"_id":"themes/landscape/source/css/_partial/article.styl","hash":"33177e822defd3a8751379c4475cf901d4d4f3e9","modified":1518502672668},{"_id":"themes/landscape/source/css/_partial/comment.styl","hash":"2834870661e490775f9154d71638bfdc72e640a6","modified":1511073850191},{"_id":"themes/landscape/source/css/_partial/header.styl","hash":"67e59feb18eee6026717cb440d86ab9551782628","modified":1511073850195},{"_id":"themes/landscape/source/css/_partial/footer.styl","hash":"6f7aa810f296d6a1a4486637b5a853d35a198938","modified":1511073850193},{"_id":"themes/landscape/source/css/_partial/highlight.styl","hash":"ac19f1621305ca9f6a7b74acd211a4c0d88690bd","modified":1511073850196},{"_id":"themes/landscape/source/css/_partial/sidebar-aside.styl","hash":"1fb15f13ba70d5b954f62920c6b63d26e2fb2985","modified":1511073850199},{"_id":"themes/landscape/source/css/_partial/mobile.styl","hash":"680c7b809b62cd3ad294e822793fbd0b1a32cc33","modified":1511073850198},{"_id":"themes/landscape/source/css/_partial/sidebar-bottom.styl","hash":"4132e25ba9680c4b911a01abc75f501cda3fa4f1","modified":1511073850200},{"_id":"themes/landscape/source/css/_partial/sidebar.styl","hash":"8d971a00e644a600179b04815688d188f094012e","modified":1511073850202},{"_id":"themes/landscape/source/css/_util/grid.styl","hash":"1aa883ab432d9e4139c89dcbd40ae2bd1528d029","modified":1511073850203},{"_id":"themes/landscape/source/css/_util/mixin.styl","hash":"429bad87fc156eacf226c5e35b0eafc277f2504b","modified":1511073850205},{"_id":"themes/landscape/source/css/fonts/FontAwesome.otf","hash":"b5b4f9be85f91f10799e87a083da1d050f842734","modified":1511073850210},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.eot","hash":"7619748fe34c64fb157a57f6d4ef3678f63a8f5e","modified":1511073850212},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.woff","hash":"04c3bf56d87a0828935bd6b4aee859995f321693","modified":1511073850219},{"_id":"themes/landscape/source/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1511073850235},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.css","hash":"6394c48092085788a8c0ef72670b0652006231a1","modified":1511073850236},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.js","hash":"4c9c395d705d22af7da06870d18f434e2a2eeaf9","modified":1511073850238},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-media.js","hash":"e14c32cc6823b81b2f758512f13ed8eb9ef2b454","modified":1511073850239},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"b88b589f5f1aa1b3d87cc7eef34c281ff749b1ae","modified":1511073850241},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"83cdfea43632b613771691a11f56f99d85fb6dbd","modified":1511073850242},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.ttf","hash":"7f09c97f333917034ad08fa7295e916c9f72fd3f","modified":1511073850217},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.svg","hash":"a275426daefd3716c53561fad121d258a7f05b47","modified":1511073850215},{"_id":"themes/landscape/source/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1511073850223},{"_id":"public/2017/11/19/ArrayToList/index.html","hash":"fa42add23be5a6c870cd337a7038315dd12fabdc","modified":1518670630326},{"_id":"public/2017/11/19/JavaInstallation/index.html","hash":"c2e785b0a4b197e22490db25c3d0e6d809760472","modified":1518670630350},{"_id":"public/categories/Data-Visualization/index.html","hash":"7bf59992395aa497feb546bf32dd5adc007d02a7","modified":1518670630358},{"_id":"public/tags/Java/index.html","hash":"f9c2e6f7121175b1d5de890bb813ca6b156c6639","modified":1518670630358},{"_id":"public/tags/JavaScript/index.html","hash":"807f52a4449fb15d3985be9d8cc9551f1e26f54a","modified":1518670630358},{"_id":"public/tags/D3/index.html","hash":"64a2ec11128471cc3175aa612b857105972cccfd","modified":1518670630358},{"_id":"public/archives/index.html","hash":"5ea52acdfdfc092c53c6bd5ec336ab0f47dcfdd7","modified":1518670630357},{"_id":"public/archives/2017/index.html","hash":"a2d566e4d02775665a2d13a8179fa7382749bc38","modified":1518670630357},{"_id":"public/archives/2017/11/index.html","hash":"2b4d0f1f31d915f9e68be3f0743ec5e1f36d9740","modified":1518670630358},{"_id":"public/archives/2018/index.html","hash":"382080790f960bbfa0b7a4fd1f21ab9541e47f49","modified":1518670630358},{"_id":"public/2018/01/19/InteractiveMap_01/index.html","hash":"8be858795cfe5b28b09716796ed8a31be55685fc","modified":1518670630359},{"_id":"public/index.html","hash":"d269286fcf16a44981aa0d3577de7c0d2a8ac5d7","modified":1518670703906},{"_id":"public/archives/2018/01/index.html","hash":"19881e675ef1c2a4556cfe86749c9129e70cc3dd","modified":1518670630358},{"_id":"public/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1518502934721},{"_id":"public/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1518502934721},{"_id":"public/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1518502934721},{"_id":"public/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1518502934721},{"_id":"public/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1518502934721},{"_id":"public/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1518502934721},{"_id":"public/css/fonts/FontAwesome.otf","hash":"b5b4f9be85f91f10799e87a083da1d050f842734","modified":1518502934722},{"_id":"public/css/fonts/fontawesome-webfont.eot","hash":"7619748fe34c64fb157a57f6d4ef3678f63a8f5e","modified":1518502934722},{"_id":"public/css/fonts/fontawesome-webfont.woff","hash":"04c3bf56d87a0828935bd6b4aee859995f321693","modified":1518502934722},{"_id":"public/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1518502934722},{"_id":"public/fancybox/jquery.fancybox.css","hash":"afd937519c849f0aadda190aaca0214133217ad7","modified":1518502935131},{"_id":"public/js/script.js","hash":"2876e0b19ce557fca38d7c6f49ca55922ab666a1","modified":1518502935131},{"_id":"public/fancybox/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1518502935132},{"_id":"public/fancybox/helpers/jquery.fancybox-media.js","hash":"294420f9ff20f4e3584d212b0c262a00a96ecdb3","modified":1518502935132},{"_id":"public/fancybox/helpers/jquery.fancybox-buttons.js","hash":"dc3645529a4bf72983a39fa34c1eb9146e082019","modified":1518502935132},{"_id":"public/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1518502935132},{"_id":"public/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"47da1ae5401c24b5c17cc18e2730780f5c1a7a0c","modified":1518502935132},{"_id":"public/css/style.css","hash":"c578620a407dffdefacdb11cf631e5f5b728a1d3","modified":1518502935132},{"_id":"public/fancybox/jquery.fancybox.pack.js","hash":"9e0d51ca1dbe66f6c0c7aefd552dc8122e694a6e","modified":1518502935132},{"_id":"public/fancybox/jquery.fancybox.js","hash":"d08b03a42d5c4ba456ef8ba33116fdbb7a9cabed","modified":1518502935132},{"_id":"public/css/fonts/fontawesome-webfont.ttf","hash":"7f09c97f333917034ad08fa7295e916c9f72fd3f","modified":1518502935128},{"_id":"public/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1518502935133},{"_id":"public/css/fonts/fontawesome-webfont.svg","hash":"a275426daefd3716c53561fad121d258a7f05b47","modified":1518502935133},{"_id":"public/categories/Java-Basics/index.html","hash":"be841913866d3f538354a9ef19a2deb4b6eb82ec","modified":1518670630358},{"_id":"source/_posts/InteractiveMap_02.md","hash":"c37636862f966b4e4b7dfe288935e22793bd7dba","modified":1518668885534},{"_id":"public/2018/01/31/InteractiveMap_02/index.html","hash":"daeb716e78d3c1cc59c378d5620b2b8593de39c5","modified":1518670630358},{"_id":"source/_posts/InteractiveMap_03.md","hash":"205e8f199ee224385113abbe998a5eca2c737ede","modified":1518670701403},{"_id":"public/2018/01/31/InteractiveMap_03/index.html","hash":"bf622d5d2aa7098497e3fef330e971bbbe0d3637","modified":1518670587204},{"_id":"public/archives/2018/02/index.html","hash":"0723b53d49e32e5b553bae866bd3c656e35e8dc6","modified":1518670630360},{"_id":"public/2018/02/05/InteractiveMap_03/index.html","hash":"237a90211835a986bd365b3f37b4d39ba7f3d479","modified":1518670703906}],"Category":[{"name":"Data Visualization","_id":"cjd8gvpk40004l4unr5gx75gs"},{"name":"Java Basics","_id":"cjd9cof1j0000iwunffne030o"}],"Data":[],"Page":[],"Post":[{"title":"Array and List in Java","date":"2017-11-19T07:52:54.000Z","_content":"In Java, `Array` and `List` have a lot in common. Now I am going to introduce how to convert them to each other.\n\n#### 1. How to convert `List` to `Array`?\n\n```java\n    List<T> list = new ArrayList<T>();\n    T [] array = list.toArray(new T[list.size()]);\n```\n\n***\n\n#### 2. How to convert `Array` to `List` in Java?\n\nThere are two ways to convert `Array` to `List`.\n\n- Flexible Length Way **(Recommendation)**\n```java\n    List list = new ArrayList(Arrays.asList(array));\n```\nThe above is recommended because it returns an `ArrayList` which has flexible length (you can add extra elements).\n\n\n- Inflexible Way\n```java\n    List list = Arrays.asList(array);\n```","source":"_posts/ArrayToList.md","raw":"---\ntitle: Array and List in Java\ndate: 2017-11-19 02:52:54\ncategories: Java Basics\ntags: Java\n---\nIn Java, `Array` and `List` have a lot in common. Now I am going to introduce how to convert them to each other.\n\n#### 1. How to convert `List` to `Array`?\n\n```java\n    List<T> list = new ArrayList<T>();\n    T [] array = list.toArray(new T[list.size()]);\n```\n\n***\n\n#### 2. How to convert `Array` to `List` in Java?\n\nThere are two ways to convert `Array` to `List`.\n\n- Flexible Length Way **(Recommendation)**\n```java\n    List list = new ArrayList(Arrays.asList(array));\n```\nThe above is recommended because it returns an `ArrayList` which has flexible length (you can add extra elements).\n\n\n- Inflexible Way\n```java\n    List list = Arrays.asList(array);\n```","slug":"ArrayToList","published":1,"updated":"2018-02-04T22:19:35.878Z","_id":"cjd8gvpjw0000l4unifjpnynz","comments":1,"layout":"post","photos":[],"link":"","content":"<p>In Java, <code>Array</code> and <code>List</code> have a lot in common. Now I am going to introduce how to convert them to each other.</p>\n<h4 id=\"1-How-to-convert-List-to-Array\"><a href=\"#1-How-to-convert-List-to-Array\" class=\"headerlink\" title=\"1. How to convert List to Array?\"></a>1. How to convert <code>List</code> to <code>Array</code>?</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;T&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;T&gt;();</span><br><span class=\"line\">T [] array = list.toArray(<span class=\"keyword\">new</span> T[list.size()]);</span><br></pre></td></tr></table></figure>\n<hr>\n<h4 id=\"2-How-to-convert-Array-to-List-in-Java\"><a href=\"#2-How-to-convert-Array-to-List-in-Java\" class=\"headerlink\" title=\"2. How to convert Array to List in Java?\"></a>2. How to convert <code>Array</code> to <code>List</code> in Java?</h4><p>There are two ways to convert <code>Array</code> to <code>List</code>.</p>\n<ul>\n<li>Flexible Length Way <strong>(Recommendation)</strong><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List list = <span class=\"keyword\">new</span> ArrayList(Arrays.asList(array));</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>The above is recommended because it returns an <code>ArrayList</code> which has flexible length (you can add extra elements).</p>\n<ul>\n<li>Inflexible Way<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List list = Arrays.asList(array);</span><br></pre></td></tr></table></figure></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>In Java, <code>Array</code> and <code>List</code> have a lot in common. Now I am going to introduce how to convert them to each other.</p>\n<h4 id=\"1-How-to-convert-List-to-Array\"><a href=\"#1-How-to-convert-List-to-Array\" class=\"headerlink\" title=\"1. How to convert List to Array?\"></a>1. How to convert <code>List</code> to <code>Array</code>?</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;T&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;T&gt;();</span><br><span class=\"line\">T [] array = list.toArray(<span class=\"keyword\">new</span> T[list.size()]);</span><br></pre></td></tr></table></figure>\n<hr>\n<h4 id=\"2-How-to-convert-Array-to-List-in-Java\"><a href=\"#2-How-to-convert-Array-to-List-in-Java\" class=\"headerlink\" title=\"2. How to convert Array to List in Java?\"></a>2. How to convert <code>Array</code> to <code>List</code> in Java?</h4><p>There are two ways to convert <code>Array</code> to <code>List</code>.</p>\n<ul>\n<li>Flexible Length Way <strong>(Recommendation)</strong><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List list = <span class=\"keyword\">new</span> ArrayList(Arrays.asList(array));</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>The above is recommended because it returns an <code>ArrayList</code> which has flexible length (you can add extra elements).</p>\n<ul>\n<li>Inflexible Way<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List list = Arrays.asList(array);</span><br></pre></td></tr></table></figure></li>\n</ul>\n"},{"title":"Make an Interactive Map 01 - \"Let's make a colorful world!\"","date":"2018-01-19T07:52:54.000Z","_content":"\n#### Prefix\nI am going to make a series of blogs to show you how to make all kinds of **interactive map** on a web page. Before start, you should have some basic knowledge about **HTML** and **JavaScript**.\n\n---\n#### Now, let's make a colorful world!\nFirst, let's see what you will be able to make.\n\nThis is a map that shows the median age of each country from 2015 to 2100 predicted by [United Nations](https://esa.un.org/unpd/wpp/Download/Standard/Population/).\n\n<iframe width=\"820\" height=\"540\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/01/basic-datamaps.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/01/basic-datamaps.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n---\n#### What tools do you use?\nFor the above map, I use the following libraries,\n- [DataMaps](http://datamaps.github.io/): A useful tool to render a `svg` map. Many basic interactions like changing color when the mouse is over are already included. \n- [D3](https://d3js.org/): A very powerful JS library especially in making data visualization. There are so many powerful features in D3, like you can use D3 as a DOM selector instead of jQuery. But we only use a tiny part of it in this map. (The latest version of D3 is v4, but **DataMaps** is using d3.v3).\n\n---\n#### Show me the code! \nSure, the following is the code. You can also find it at this [Github repository](https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/01).\n\nAlso, you can find a more advanced map [here](https://brucehenry.github.io/WorldPopulationData/).\n##### HTML\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width\">\n    <title>Basic Interactive Map</title>\n    <link rel=\"stylesheet\" href=\"./basic-datamaps.css\"/>\n\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"></script>\n</head>\n<body>\n\n<div id=\"map\"></div>\n\n<div id=\"input\">\n    <table>\n        <tr>\n            <th rowspan=\"2\">Year</th>\n            <td colspan=\"19\">\n                <label for=\"year\"></label>\n                <input type=\"range\" min=\"2015\" max=\"2100\" step=\"5\" value=\"2015\" autocomplete=\"off\" id=\"year\"/>\n            </td>\n        </tr>\n        <tr>\n            <td>2015</td>\n            <td>2020</td>\n            <td>2025</td>\n            <td>2030</td>\n            <td>2035</td>\n            <td>2040</td>\n            <td>2045</td>\n            <td>2050</td>\n            <td>2055</td>\n            <td>2060</td>\n            <td>2065</td>\n            <td>2070</td>\n            <td>2075</td>\n            <td>2080</td>\n            <td>2085</td>\n            <td>2090</td>\n            <td>2095</td>\n            <td>2100</td>\n        </tr>\n    </table>\n    <p><b> Try dragging the slider.</b></p>\n</div>\n\n<script src=\"./basic-datamaps.js\"></script>\n</body>\n</html>\n```\n***\n##### JavaScript\n```javascript\nvar json_data;//To store the data from JSON file loaded by d3.json()\n\nfunction renderMap() {\n    var data = {};//A object to store values and colors, i.e. { USA: { numberOfThings: 37.6, fillColor: \"#333e90\"} }\n    var values = [];//The array to store all the values in order to find min and max\n\n    var year = document.getElementById('year').value;//Get value from input\n\n    //Iterate the data array to retrieve the value of each country in the specific year\n    for (var country in json_data) {\n        var value = json_data[country]['data'][year];\n        data[country] = {numberOfThings: value};\n        values.push(value)\n    }\n\n    //Get min and max values to set the color scale\n    var minValue = Math.min.apply(null, values),\n        maxValue = Math.max.apply(null, values);\n\n    //Use d3 to convert number to color\n    var colorScale = d3.scale.linear()\n        .domain([minValue, maxValue])\n        .range([\"#afe0ff\", \"#040066\"]);\n\n    //Put color into the data array for each country\n    for (var country in data) {\n        data[country]['fillColor'] = colorScale(data[country]['numberOfThings'])\n    }\n    \n    //Call DataMaps\n    new Datamaps({\n        element: document.getElementById('map'),\n        projection: 'mercator', // big world map\n        fills: {defaultFill: '#F5F5F5'},// countries don't listed in dataset will be painted with this color\n        data: data,\n        geographyConfig: {\n            borderColor: '#d7d7d7',\n            highlightBorderWidth: 2,\n            highlightBorderColor: '#e66d18',\n            popupTemplate: function (geo, data) {// show desired information in tooltip\n                if (!data) // don't show tooltip if country don't present in dataset\n                    return;\n                // tooltip content\n                return ['<div class=\"hoverinfo\">',\n                    '<strong>', geo.properties.name, '</strong>',\n                    '<br>Median Age: <strong>', data.numberOfThings, '</strong>',\n                    '</div>'].join('');\n            }\n        }\n    });\n}\n\n//Asynchronously load the data file\nd3.json(\"./MedianAge.json\", function (data) {\n    json_data = data;\n    renderMap();//Render the map after loading the data\n});\n\n///Remove the old map and render a new map when the user change input\ndocument.getElementById('year').oninput = function () {\n    //Remove the old map\n    var mapNode = document.getElementById(\"map\");\n    while (mapNode.firstChild) {\n        mapNode.removeChild(mapNode.firstChild);\n    }\n    renderMap();//Render a new map when the year is changed\n};\n```\n***\n##### CSS\n```css\n#map {\n    width: 800px;\n    height: 425px;\n    position: relative;\n    margin: auto;\n}\n\n#input {\n    width: 800px;\n    position: relative;\n    margin: auto;\n}\n\ntable {\n    width: 100%;\n}\n\nth {\n    color: #e66d18;\n    font-size: 25px;\n}\n\ntr {\n    color: #0026bf;\n    font-size: 12px;\n    font-weight: bold;\n    text-align: center;\n}\n\n#year {\n    -webkit-appearance: none;\n    width: 98%;\n    height: 15px;\n    border-radius: 5px;\n    background: #99ccff;\n    outline: none;\n    opacity: 0.7;\n    -webkit-transition: .2s;\n    transition: opacity .2s;\n}\n\n#year::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-thumb {\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-track {\n    background: none;\n}\n\np {\n    text-align: center;\n    color: #e66d18;\n}\n```\n***\n##### Part of the Data File\n```json\n{\n    \"BDI\": {\n        \"name\": \"Burundi\",\n        \"data\": {\n            \"2015\": 17.6,\n            \"2020\": 17.5,\n            \"2025\": 17.8,\n            \"2030\": 18.6,\n            \"2035\": 19.5,\n            \"2040\": 20.4,\n            \"2045\": 21.2,\n            \"2050\": 22.0,\n            \"2055\": 22.9,\n            \"2060\": 23.8,\n            \"2065\": 24.7,\n            \"2070\": 25.8,\n            \"2075\": 26.8,\n            \"2080\": 27.8,\n            \"2085\": 28.9,\n            \"2090\": 29.8,\n            \"2095\": 30.9,\n            \"2100\": 31.9\n        }\n    }\n}\n```\n---","source":"_posts/InteractiveMap_01.md","raw":"---\ntitle: Make an Interactive Map 01 - \"Let's make a colorful world!\"\ndate: 2018-01-19 02:52:54\ncategories:\n- Data Visualization\ntags:\n- JavaScript\n- D3\n---\n\n#### Prefix\nI am going to make a series of blogs to show you how to make all kinds of **interactive map** on a web page. Before start, you should have some basic knowledge about **HTML** and **JavaScript**.\n\n---\n#### Now, let's make a colorful world!\nFirst, let's see what you will be able to make.\n\nThis is a map that shows the median age of each country from 2015 to 2100 predicted by [United Nations](https://esa.un.org/unpd/wpp/Download/Standard/Population/).\n\n<iframe width=\"820\" height=\"540\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/01/basic-datamaps.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/01/basic-datamaps.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n---\n#### What tools do you use?\nFor the above map, I use the following libraries,\n- [DataMaps](http://datamaps.github.io/): A useful tool to render a `svg` map. Many basic interactions like changing color when the mouse is over are already included. \n- [D3](https://d3js.org/): A very powerful JS library especially in making data visualization. There are so many powerful features in D3, like you can use D3 as a DOM selector instead of jQuery. But we only use a tiny part of it in this map. (The latest version of D3 is v4, but **DataMaps** is using d3.v3).\n\n---\n#### Show me the code! \nSure, the following is the code. You can also find it at this [Github repository](https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/01).\n\nAlso, you can find a more advanced map [here](https://brucehenry.github.io/WorldPopulationData/).\n##### HTML\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width\">\n    <title>Basic Interactive Map</title>\n    <link rel=\"stylesheet\" href=\"./basic-datamaps.css\"/>\n\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"></script>\n</head>\n<body>\n\n<div id=\"map\"></div>\n\n<div id=\"input\">\n    <table>\n        <tr>\n            <th rowspan=\"2\">Year</th>\n            <td colspan=\"19\">\n                <label for=\"year\"></label>\n                <input type=\"range\" min=\"2015\" max=\"2100\" step=\"5\" value=\"2015\" autocomplete=\"off\" id=\"year\"/>\n            </td>\n        </tr>\n        <tr>\n            <td>2015</td>\n            <td>2020</td>\n            <td>2025</td>\n            <td>2030</td>\n            <td>2035</td>\n            <td>2040</td>\n            <td>2045</td>\n            <td>2050</td>\n            <td>2055</td>\n            <td>2060</td>\n            <td>2065</td>\n            <td>2070</td>\n            <td>2075</td>\n            <td>2080</td>\n            <td>2085</td>\n            <td>2090</td>\n            <td>2095</td>\n            <td>2100</td>\n        </tr>\n    </table>\n    <p><b> Try dragging the slider.</b></p>\n</div>\n\n<script src=\"./basic-datamaps.js\"></script>\n</body>\n</html>\n```\n***\n##### JavaScript\n```javascript\nvar json_data;//To store the data from JSON file loaded by d3.json()\n\nfunction renderMap() {\n    var data = {};//A object to store values and colors, i.e. { USA: { numberOfThings: 37.6, fillColor: \"#333e90\"} }\n    var values = [];//The array to store all the values in order to find min and max\n\n    var year = document.getElementById('year').value;//Get value from input\n\n    //Iterate the data array to retrieve the value of each country in the specific year\n    for (var country in json_data) {\n        var value = json_data[country]['data'][year];\n        data[country] = {numberOfThings: value};\n        values.push(value)\n    }\n\n    //Get min and max values to set the color scale\n    var minValue = Math.min.apply(null, values),\n        maxValue = Math.max.apply(null, values);\n\n    //Use d3 to convert number to color\n    var colorScale = d3.scale.linear()\n        .domain([minValue, maxValue])\n        .range([\"#afe0ff\", \"#040066\"]);\n\n    //Put color into the data array for each country\n    for (var country in data) {\n        data[country]['fillColor'] = colorScale(data[country]['numberOfThings'])\n    }\n    \n    //Call DataMaps\n    new Datamaps({\n        element: document.getElementById('map'),\n        projection: 'mercator', // big world map\n        fills: {defaultFill: '#F5F5F5'},// countries don't listed in dataset will be painted with this color\n        data: data,\n        geographyConfig: {\n            borderColor: '#d7d7d7',\n            highlightBorderWidth: 2,\n            highlightBorderColor: '#e66d18',\n            popupTemplate: function (geo, data) {// show desired information in tooltip\n                if (!data) // don't show tooltip if country don't present in dataset\n                    return;\n                // tooltip content\n                return ['<div class=\"hoverinfo\">',\n                    '<strong>', geo.properties.name, '</strong>',\n                    '<br>Median Age: <strong>', data.numberOfThings, '</strong>',\n                    '</div>'].join('');\n            }\n        }\n    });\n}\n\n//Asynchronously load the data file\nd3.json(\"./MedianAge.json\", function (data) {\n    json_data = data;\n    renderMap();//Render the map after loading the data\n});\n\n///Remove the old map and render a new map when the user change input\ndocument.getElementById('year').oninput = function () {\n    //Remove the old map\n    var mapNode = document.getElementById(\"map\");\n    while (mapNode.firstChild) {\n        mapNode.removeChild(mapNode.firstChild);\n    }\n    renderMap();//Render a new map when the year is changed\n};\n```\n***\n##### CSS\n```css\n#map {\n    width: 800px;\n    height: 425px;\n    position: relative;\n    margin: auto;\n}\n\n#input {\n    width: 800px;\n    position: relative;\n    margin: auto;\n}\n\ntable {\n    width: 100%;\n}\n\nth {\n    color: #e66d18;\n    font-size: 25px;\n}\n\ntr {\n    color: #0026bf;\n    font-size: 12px;\n    font-weight: bold;\n    text-align: center;\n}\n\n#year {\n    -webkit-appearance: none;\n    width: 98%;\n    height: 15px;\n    border-radius: 5px;\n    background: #99ccff;\n    outline: none;\n    opacity: 0.7;\n    -webkit-transition: .2s;\n    transition: opacity .2s;\n}\n\n#year::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-thumb {\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-track {\n    background: none;\n}\n\np {\n    text-align: center;\n    color: #e66d18;\n}\n```\n***\n##### Part of the Data File\n```json\n{\n    \"BDI\": {\n        \"name\": \"Burundi\",\n        \"data\": {\n            \"2015\": 17.6,\n            \"2020\": 17.5,\n            \"2025\": 17.8,\n            \"2030\": 18.6,\n            \"2035\": 19.5,\n            \"2040\": 20.4,\n            \"2045\": 21.2,\n            \"2050\": 22.0,\n            \"2055\": 22.9,\n            \"2060\": 23.8,\n            \"2065\": 24.7,\n            \"2070\": 25.8,\n            \"2075\": 26.8,\n            \"2080\": 27.8,\n            \"2085\": 28.9,\n            \"2090\": 29.8,\n            \"2095\": 30.9,\n            \"2100\": 31.9\n        }\n    }\n}\n```\n---","slug":"InteractiveMap_01","published":1,"updated":"2018-02-14T10:58:08.443Z","_id":"cjd8gvpk00001l4und3mleixp","comments":1,"layout":"post","photos":[],"link":"","content":"<h4 id=\"Prefix\"><a href=\"#Prefix\" class=\"headerlink\" title=\"Prefix\"></a>Prefix</h4><p>I am going to make a series of blogs to show you how to make all kinds of <strong>interactive map</strong> on a web page. Before start, you should have some basic knowledge about <strong>HTML</strong> and <strong>JavaScript</strong>.</p>\n<hr>\n<h4 id=\"Now-let’s-make-a-colorful-world\"><a href=\"#Now-let’s-make-a-colorful-world\" class=\"headerlink\" title=\"Now, let’s make a colorful world!\"></a>Now, let’s make a colorful world!</h4><p>First, let’s see what you will be able to make.</p>\n<p>This is a map that shows the median age of each country from 2015 to 2100 predicted by <a href=\"https://esa.un.org/unpd/wpp/Download/Standard/Population/\" target=\"_blank\" rel=\"noopener\">United Nations</a>.</p>\n<iframe width=\"820\" height=\"540\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/01/basic-datamaps.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/01/basic-datamaps.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n<hr>\n<h4 id=\"What-tools-do-you-use\"><a href=\"#What-tools-do-you-use\" class=\"headerlink\" title=\"What tools do you use?\"></a>What tools do you use?</h4><p>For the above map, I use the following libraries,</p>\n<ul>\n<li><a href=\"http://datamaps.github.io/\" target=\"_blank\" rel=\"noopener\">DataMaps</a>: A useful tool to render a <code>svg</code> map. Many basic interactions like changing color when the mouse is over are already included. </li>\n<li><a href=\"https://d3js.org/\" target=\"_blank\" rel=\"noopener\">D3</a>: A very powerful JS library especially in making data visualization. There are so many powerful features in D3, like you can use D3 as a DOM selector instead of jQuery. But we only use a tiny part of it in this map. (The latest version of D3 is v4, but <strong>DataMaps</strong> is using d3.v3).</li>\n</ul>\n<hr>\n<h4 id=\"Show-me-the-code\"><a href=\"#Show-me-the-code\" class=\"headerlink\" title=\"Show me the code!\"></a>Show me the code!</h4><p>Sure, the following is the code. You can also find it at this <a href=\"https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/01\" target=\"_blank\" rel=\"noopener\">Github repository</a>.</p>\n<p>Also, you can find a more advanced map <a href=\"https://brucehenry.github.io/WorldPopulationData/\">here</a>.</p>\n<h5 id=\"HTML\"><a href=\"#HTML\" class=\"headerlink\" title=\"HTML\"></a>HTML</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Basic Interactive Map<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"./basic-datamaps.css\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"input\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">th</span> <span class=\"attr\">rowspan</span>=<span class=\"string\">\"2\"</span>&gt;</span>Year<span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">colspan</span>=<span class=\"string\">\"19\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"year\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"range\"</span> <span class=\"attr\">min</span>=<span class=\"string\">\"2015\"</span> <span class=\"attr\">max</span>=<span class=\"string\">\"2100\"</span> <span class=\"attr\">step</span>=<span class=\"string\">\"5\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"2015\"</span> <span class=\"attr\">autocomplete</span>=<span class=\"string\">\"off\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"year\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2015<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2020<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2025<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2030<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2035<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2040<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2045<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2050<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2055<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2060<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2065<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2070<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2075<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2080<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2085<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2090<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2095<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2100<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">b</span>&gt;</span> Try dragging the slider.<span class=\"tag\">&lt;/<span class=\"name\">b</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./basic-datamaps.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"JavaScript\"><a href=\"#JavaScript\" class=\"headerlink\" title=\"JavaScript\"></a>JavaScript</h5><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> json_data;<span class=\"comment\">//To store the data from JSON file loaded by d3.json()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">renderMap</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = &#123;&#125;;<span class=\"comment\">//A object to store values and colors, i.e. &#123; USA: &#123; numberOfThings: 37.6, fillColor: \"#333e90\"&#125; &#125;</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> values = [];<span class=\"comment\">//The array to store all the values in order to find min and max</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'year'</span>).value;<span class=\"comment\">//Get value from input</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Iterate the data array to retrieve the value of each country in the specific year</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> country <span class=\"keyword\">in</span> json_data) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> value = json_data[country][<span class=\"string\">'data'</span>][year];</span><br><span class=\"line\">        data[country] = &#123;<span class=\"attr\">numberOfThings</span>: value&#125;;</span><br><span class=\"line\">        values.push(value)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Get min and max values to set the color scale</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> minValue = <span class=\"built_in\">Math</span>.min.apply(<span class=\"literal\">null</span>, values),</span><br><span class=\"line\">        maxValue = <span class=\"built_in\">Math</span>.max.apply(<span class=\"literal\">null</span>, values);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Use d3 to convert number to color</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> colorScale = d3.scale.linear()</span><br><span class=\"line\">        .domain([minValue, maxValue])</span><br><span class=\"line\">        .range([<span class=\"string\">\"#afe0ff\"</span>, <span class=\"string\">\"#040066\"</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Put color into the data array for each country</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> country <span class=\"keyword\">in</span> data) &#123;</span><br><span class=\"line\">        data[country][<span class=\"string\">'fillColor'</span>] = colorScale(data[country][<span class=\"string\">'numberOfThings'</span>])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//Call DataMaps</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> Datamaps(&#123;</span><br><span class=\"line\">        element: <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'map'</span>),</span><br><span class=\"line\">        projection: <span class=\"string\">'mercator'</span>, <span class=\"comment\">// big world map</span></span><br><span class=\"line\">        fills: &#123;<span class=\"attr\">defaultFill</span>: <span class=\"string\">'#F5F5F5'</span>&#125;,<span class=\"comment\">// countries don't listed in dataset will be painted with this color</span></span><br><span class=\"line\">        data: data,</span><br><span class=\"line\">        geographyConfig: &#123;</span><br><span class=\"line\">            borderColor: <span class=\"string\">'#d7d7d7'</span>,</span><br><span class=\"line\">            highlightBorderWidth: <span class=\"number\">2</span>,</span><br><span class=\"line\">            highlightBorderColor: <span class=\"string\">'#e66d18'</span>,</span><br><span class=\"line\">            popupTemplate: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">geo, data</span>) </span>&#123;<span class=\"comment\">// show desired information in tooltip</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!data) <span class=\"comment\">// don't show tooltip if country don't present in dataset</span></span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                <span class=\"comment\">// tooltip content</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> [<span class=\"string\">'&lt;div class=\"hoverinfo\"&gt;'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'&lt;strong&gt;'</span>, geo.properties.name, <span class=\"string\">'&lt;/strong&gt;'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'&lt;br&gt;Median Age: &lt;strong&gt;'</span>, data.numberOfThings, <span class=\"string\">'&lt;/strong&gt;'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'&lt;/div&gt;'</span>].join(<span class=\"string\">''</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Asynchronously load the data file</span></span><br><span class=\"line\">d3.json(<span class=\"string\">\"./MedianAge.json\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">    json_data = data;</span><br><span class=\"line\">    renderMap();<span class=\"comment\">//Render the map after loading the data</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///Remove the old map and render a new map when the user change input</span></span><br><span class=\"line\"><span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'year'</span>).oninput = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove the old map</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> mapNode = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">\"map\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (mapNode.firstChild) &#123;</span><br><span class=\"line\">        mapNode.removeChild(mapNode.firstChild);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    renderMap();<span class=\"comment\">//Render a new map when the year is changed</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"CSS\"><a href=\"#CSS\" class=\"headerlink\" title=\"CSS\"></a>CSS</h5><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#map</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">425px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#input</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">table</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">th</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#e66d18</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">tr</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#0026bf</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">12px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">98%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#99ccff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">outline</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: <span class=\"number\">0.7</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-transition</span>: .<span class=\"number\">2s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: opacity .<span class=\"number\">2s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-webkit-slider-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-track</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">p</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#e66d18</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"Part-of-the-Data-File\"><a href=\"#Part-of-the-Data-File\" class=\"headerlink\" title=\"Part of the Data File\"></a>Part of the Data File</h5><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"BDI\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"Burundi\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"data\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"2015\"</span>: <span class=\"number\">17.6</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2020\"</span>: <span class=\"number\">17.5</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2025\"</span>: <span class=\"number\">17.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2030\"</span>: <span class=\"number\">18.6</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2035\"</span>: <span class=\"number\">19.5</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2040\"</span>: <span class=\"number\">20.4</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2045\"</span>: <span class=\"number\">21.2</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2050\"</span>: <span class=\"number\">22.0</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2055\"</span>: <span class=\"number\">22.9</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2060\"</span>: <span class=\"number\">23.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2065\"</span>: <span class=\"number\">24.7</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2070\"</span>: <span class=\"number\">25.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2075\"</span>: <span class=\"number\">26.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2080\"</span>: <span class=\"number\">27.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2085\"</span>: <span class=\"number\">28.9</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2090\"</span>: <span class=\"number\">29.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2095\"</span>: <span class=\"number\">30.9</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2100\"</span>: <span class=\"number\">31.9</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<hr>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"Prefix\"><a href=\"#Prefix\" class=\"headerlink\" title=\"Prefix\"></a>Prefix</h4><p>I am going to make a series of blogs to show you how to make all kinds of <strong>interactive map</strong> on a web page. Before start, you should have some basic knowledge about <strong>HTML</strong> and <strong>JavaScript</strong>.</p>\n<hr>\n<h4 id=\"Now-let’s-make-a-colorful-world\"><a href=\"#Now-let’s-make-a-colorful-world\" class=\"headerlink\" title=\"Now, let’s make a colorful world!\"></a>Now, let’s make a colorful world!</h4><p>First, let’s see what you will be able to make.</p>\n<p>This is a map that shows the median age of each country from 2015 to 2100 predicted by <a href=\"https://esa.un.org/unpd/wpp/Download/Standard/Population/\" target=\"_blank\" rel=\"noopener\">United Nations</a>.</p>\n<iframe width=\"820\" height=\"540\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/01/basic-datamaps.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/01/basic-datamaps.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n<hr>\n<h4 id=\"What-tools-do-you-use\"><a href=\"#What-tools-do-you-use\" class=\"headerlink\" title=\"What tools do you use?\"></a>What tools do you use?</h4><p>For the above map, I use the following libraries,</p>\n<ul>\n<li><a href=\"http://datamaps.github.io/\" target=\"_blank\" rel=\"noopener\">DataMaps</a>: A useful tool to render a <code>svg</code> map. Many basic interactions like changing color when the mouse is over are already included. </li>\n<li><a href=\"https://d3js.org/\" target=\"_blank\" rel=\"noopener\">D3</a>: A very powerful JS library especially in making data visualization. There are so many powerful features in D3, like you can use D3 as a DOM selector instead of jQuery. But we only use a tiny part of it in this map. (The latest version of D3 is v4, but <strong>DataMaps</strong> is using d3.v3).</li>\n</ul>\n<hr>\n<h4 id=\"Show-me-the-code\"><a href=\"#Show-me-the-code\" class=\"headerlink\" title=\"Show me the code!\"></a>Show me the code!</h4><p>Sure, the following is the code. You can also find it at this <a href=\"https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/01\" target=\"_blank\" rel=\"noopener\">Github repository</a>.</p>\n<p>Also, you can find a more advanced map <a href=\"https://brucehenry.github.io/WorldPopulationData/\">here</a>.</p>\n<h5 id=\"HTML\"><a href=\"#HTML\" class=\"headerlink\" title=\"HTML\"></a>HTML</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Basic Interactive Map<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"./basic-datamaps.css\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"input\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">th</span> <span class=\"attr\">rowspan</span>=<span class=\"string\">\"2\"</span>&gt;</span>Year<span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">colspan</span>=<span class=\"string\">\"19\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"year\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"range\"</span> <span class=\"attr\">min</span>=<span class=\"string\">\"2015\"</span> <span class=\"attr\">max</span>=<span class=\"string\">\"2100\"</span> <span class=\"attr\">step</span>=<span class=\"string\">\"5\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"2015\"</span> <span class=\"attr\">autocomplete</span>=<span class=\"string\">\"off\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"year\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2015<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2020<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2025<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2030<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2035<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2040<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2045<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2050<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2055<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2060<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2065<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2070<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2075<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2080<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2085<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2090<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2095<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2100<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">b</span>&gt;</span> Try dragging the slider.<span class=\"tag\">&lt;/<span class=\"name\">b</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./basic-datamaps.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"JavaScript\"><a href=\"#JavaScript\" class=\"headerlink\" title=\"JavaScript\"></a>JavaScript</h5><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> json_data;<span class=\"comment\">//To store the data from JSON file loaded by d3.json()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">renderMap</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = &#123;&#125;;<span class=\"comment\">//A object to store values and colors, i.e. &#123; USA: &#123; numberOfThings: 37.6, fillColor: \"#333e90\"&#125; &#125;</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> values = [];<span class=\"comment\">//The array to store all the values in order to find min and max</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'year'</span>).value;<span class=\"comment\">//Get value from input</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Iterate the data array to retrieve the value of each country in the specific year</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> country <span class=\"keyword\">in</span> json_data) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> value = json_data[country][<span class=\"string\">'data'</span>][year];</span><br><span class=\"line\">        data[country] = &#123;<span class=\"attr\">numberOfThings</span>: value&#125;;</span><br><span class=\"line\">        values.push(value)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Get min and max values to set the color scale</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> minValue = <span class=\"built_in\">Math</span>.min.apply(<span class=\"literal\">null</span>, values),</span><br><span class=\"line\">        maxValue = <span class=\"built_in\">Math</span>.max.apply(<span class=\"literal\">null</span>, values);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Use d3 to convert number to color</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> colorScale = d3.scale.linear()</span><br><span class=\"line\">        .domain([minValue, maxValue])</span><br><span class=\"line\">        .range([<span class=\"string\">\"#afe0ff\"</span>, <span class=\"string\">\"#040066\"</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Put color into the data array for each country</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> country <span class=\"keyword\">in</span> data) &#123;</span><br><span class=\"line\">        data[country][<span class=\"string\">'fillColor'</span>] = colorScale(data[country][<span class=\"string\">'numberOfThings'</span>])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//Call DataMaps</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> Datamaps(&#123;</span><br><span class=\"line\">        element: <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'map'</span>),</span><br><span class=\"line\">        projection: <span class=\"string\">'mercator'</span>, <span class=\"comment\">// big world map</span></span><br><span class=\"line\">        fills: &#123;<span class=\"attr\">defaultFill</span>: <span class=\"string\">'#F5F5F5'</span>&#125;,<span class=\"comment\">// countries don't listed in dataset will be painted with this color</span></span><br><span class=\"line\">        data: data,</span><br><span class=\"line\">        geographyConfig: &#123;</span><br><span class=\"line\">            borderColor: <span class=\"string\">'#d7d7d7'</span>,</span><br><span class=\"line\">            highlightBorderWidth: <span class=\"number\">2</span>,</span><br><span class=\"line\">            highlightBorderColor: <span class=\"string\">'#e66d18'</span>,</span><br><span class=\"line\">            popupTemplate: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">geo, data</span>) </span>&#123;<span class=\"comment\">// show desired information in tooltip</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!data) <span class=\"comment\">// don't show tooltip if country don't present in dataset</span></span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                <span class=\"comment\">// tooltip content</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> [<span class=\"string\">'&lt;div class=\"hoverinfo\"&gt;'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'&lt;strong&gt;'</span>, geo.properties.name, <span class=\"string\">'&lt;/strong&gt;'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'&lt;br&gt;Median Age: &lt;strong&gt;'</span>, data.numberOfThings, <span class=\"string\">'&lt;/strong&gt;'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'&lt;/div&gt;'</span>].join(<span class=\"string\">''</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Asynchronously load the data file</span></span><br><span class=\"line\">d3.json(<span class=\"string\">\"./MedianAge.json\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">    json_data = data;</span><br><span class=\"line\">    renderMap();<span class=\"comment\">//Render the map after loading the data</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///Remove the old map and render a new map when the user change input</span></span><br><span class=\"line\"><span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'year'</span>).oninput = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove the old map</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> mapNode = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">\"map\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (mapNode.firstChild) &#123;</span><br><span class=\"line\">        mapNode.removeChild(mapNode.firstChild);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    renderMap();<span class=\"comment\">//Render a new map when the year is changed</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"CSS\"><a href=\"#CSS\" class=\"headerlink\" title=\"CSS\"></a>CSS</h5><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#map</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">425px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#input</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">table</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">th</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#e66d18</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">tr</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#0026bf</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">12px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">98%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#99ccff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">outline</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: <span class=\"number\">0.7</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-transition</span>: .<span class=\"number\">2s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: opacity .<span class=\"number\">2s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-webkit-slider-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-track</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">p</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#e66d18</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"Part-of-the-Data-File\"><a href=\"#Part-of-the-Data-File\" class=\"headerlink\" title=\"Part of the Data File\"></a>Part of the Data File</h5><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"BDI\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"Burundi\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"data\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"2015\"</span>: <span class=\"number\">17.6</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2020\"</span>: <span class=\"number\">17.5</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2025\"</span>: <span class=\"number\">17.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2030\"</span>: <span class=\"number\">18.6</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2035\"</span>: <span class=\"number\">19.5</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2040\"</span>: <span class=\"number\">20.4</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2045\"</span>: <span class=\"number\">21.2</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2050\"</span>: <span class=\"number\">22.0</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2055\"</span>: <span class=\"number\">22.9</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2060\"</span>: <span class=\"number\">23.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2065\"</span>: <span class=\"number\">24.7</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2070\"</span>: <span class=\"number\">25.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2075\"</span>: <span class=\"number\">26.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2080\"</span>: <span class=\"number\">27.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2085\"</span>: <span class=\"number\">28.9</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2090\"</span>: <span class=\"number\">29.8</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2095\"</span>: <span class=\"number\">30.9</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"2100\"</span>: <span class=\"number\">31.9</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<hr>\n"},{"title":"How to install Java on Windows?","date":"2017-11-19T07:45:45.000Z","_content":"\n## 1. Download and install JDK.\n\nThere are many ways to download JDK, but I recommend you to download it from [Oracle](http://www.oracle.com/technetwork/java/javase/downloads/index.html).\n\nAfter downloading, install it just as you install other software. You'd better remember where you install it, because you need to set the environment variable later.\n\n---\n## 2. Set the environment variables as following.\n\nThis step is very **important**, please be patient.\n\n- JAVA_HOME：C:\\Program Files\\Java\\jdk1.8.0_102\n\n     **Note:**  Input the path where you installed JDK, the above example is the default path on Windows.\n\n- JDK_HOME：%JAVA_HOME%\n- JRE_HOME：%JAVA_HOME%\\jre\n- Path： **Append** `%JAVA_HOME%\\bin` (you may need to append a `;` first. It depends on whether this was a `;` at the end of your original path. So you may append `;%JAVA_HOME%\\bin`). Do **NOT** change the original content of \"Path\".\n\n- CLASSPATH：.;%JAVA_HOME%\\lib;%JAVA_HOME%\\jre\\lib\n\n\n---\n## 3. Examine the Installation\n\nOpen the Terminal (On Windows, press 'Win' + 'R', then input `cmd` and press 'Enter'), input:\n\n```bash\n    java -version\n```\n\nYou should see the version information of Java.\n\n---\n## 4. Welcome to the world of Java.","source":"_posts/JavaInstallation.md","raw":"---\ntitle: How to install Java on Windows?\ndate: 2017-11-19 02:45:45\ncategories: Java Basics\ntags: Java\n---\n\n## 1. Download and install JDK.\n\nThere are many ways to download JDK, but I recommend you to download it from [Oracle](http://www.oracle.com/technetwork/java/javase/downloads/index.html).\n\nAfter downloading, install it just as you install other software. You'd better remember where you install it, because you need to set the environment variable later.\n\n---\n## 2. Set the environment variables as following.\n\nThis step is very **important**, please be patient.\n\n- JAVA_HOME：C:\\Program Files\\Java\\jdk1.8.0_102\n\n     **Note:**  Input the path where you installed JDK, the above example is the default path on Windows.\n\n- JDK_HOME：%JAVA_HOME%\n- JRE_HOME：%JAVA_HOME%\\jre\n- Path： **Append** `%JAVA_HOME%\\bin` (you may need to append a `;` first. It depends on whether this was a `;` at the end of your original path. So you may append `;%JAVA_HOME%\\bin`). Do **NOT** change the original content of \"Path\".\n\n- CLASSPATH：.;%JAVA_HOME%\\lib;%JAVA_HOME%\\jre\\lib\n\n\n---\n## 3. Examine the Installation\n\nOpen the Terminal (On Windows, press 'Win' + 'R', then input `cmd` and press 'Enter'), input:\n\n```bash\n    java -version\n```\n\nYou should see the version information of Java.\n\n---\n## 4. Welcome to the world of Java.","slug":"JavaInstallation","published":1,"updated":"2018-02-04T22:19:35.863Z","_id":"cjd8gvpk30003l4unk6s2mlkw","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"1-Download-and-install-JDK\"><a href=\"#1-Download-and-install-JDK\" class=\"headerlink\" title=\"1. Download and install JDK.\"></a>1. Download and install JDK.</h2><p>There are many ways to download JDK, but I recommend you to download it from <a href=\"http://www.oracle.com/technetwork/java/javase/downloads/index.html\" target=\"_blank\" rel=\"noopener\">Oracle</a>.</p>\n<p>After downloading, install it just as you install other software. You’d better remember where you install it, because you need to set the environment variable later.</p>\n<hr>\n<h2 id=\"2-Set-the-environment-variables-as-following\"><a href=\"#2-Set-the-environment-variables-as-following\" class=\"headerlink\" title=\"2. Set the environment variables as following.\"></a>2. Set the environment variables as following.</h2><p>This step is very <strong>important</strong>, please be patient.</p>\n<ul>\n<li><p>JAVA_HOME：C:\\Program Files\\Java\\jdk1.8.0_102</p>\n<p>   <strong>Note:</strong>  Input the path where you installed JDK, the above example is the default path on Windows.</p>\n</li>\n<li><p>JDK_HOME：%JAVA_HOME%</p>\n</li>\n<li>JRE_HOME：%JAVA_HOME%\\jre</li>\n<li><p>Path： <strong>Append</strong> <code>%JAVA_HOME%\\bin</code> (you may need to append a <code>;</code> first. It depends on whether this was a <code>;</code> at the end of your original path. So you may append <code>;%JAVA_HOME%\\bin</code>). Do <strong>NOT</strong> change the original content of “Path”.</p>\n</li>\n<li><p>CLASSPATH：.;%JAVA_HOME%\\lib;%JAVA_HOME%\\jre\\lib</p>\n</li>\n</ul>\n<hr>\n<h2 id=\"3-Examine-the-Installation\"><a href=\"#3-Examine-the-Installation\" class=\"headerlink\" title=\"3. Examine the Installation\"></a>3. Examine the Installation</h2><p>Open the Terminal (On Windows, press ‘Win’ + ‘R’, then input <code>cmd</code> and press ‘Enter’), input:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -version</span><br></pre></td></tr></table></figure>\n<p>You should see the version information of Java.</p>\n<hr>\n<h2 id=\"4-Welcome-to-the-world-of-Java\"><a href=\"#4-Welcome-to-the-world-of-Java\" class=\"headerlink\" title=\"4. Welcome to the world of Java.\"></a>4. Welcome to the world of Java.</h2>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"1-Download-and-install-JDK\"><a href=\"#1-Download-and-install-JDK\" class=\"headerlink\" title=\"1. Download and install JDK.\"></a>1. Download and install JDK.</h2><p>There are many ways to download JDK, but I recommend you to download it from <a href=\"http://www.oracle.com/technetwork/java/javase/downloads/index.html\" target=\"_blank\" rel=\"noopener\">Oracle</a>.</p>\n<p>After downloading, install it just as you install other software. You’d better remember where you install it, because you need to set the environment variable later.</p>\n<hr>\n<h2 id=\"2-Set-the-environment-variables-as-following\"><a href=\"#2-Set-the-environment-variables-as-following\" class=\"headerlink\" title=\"2. Set the environment variables as following.\"></a>2. Set the environment variables as following.</h2><p>This step is very <strong>important</strong>, please be patient.</p>\n<ul>\n<li><p>JAVA_HOME：C:\\Program Files\\Java\\jdk1.8.0_102</p>\n<p>   <strong>Note:</strong>  Input the path where you installed JDK, the above example is the default path on Windows.</p>\n</li>\n<li><p>JDK_HOME：%JAVA_HOME%</p>\n</li>\n<li>JRE_HOME：%JAVA_HOME%\\jre</li>\n<li><p>Path： <strong>Append</strong> <code>%JAVA_HOME%\\bin</code> (you may need to append a <code>;</code> first. It depends on whether this was a <code>;</code> at the end of your original path. So you may append <code>;%JAVA_HOME%\\bin</code>). Do <strong>NOT</strong> change the original content of “Path”.</p>\n</li>\n<li><p>CLASSPATH：.;%JAVA_HOME%\\lib;%JAVA_HOME%\\jre\\lib</p>\n</li>\n</ul>\n<hr>\n<h2 id=\"3-Examine-the-Installation\"><a href=\"#3-Examine-the-Installation\" class=\"headerlink\" title=\"3. Examine the Installation\"></a>3. Examine the Installation</h2><p>Open the Terminal (On Windows, press ‘Win’ + ‘R’, then input <code>cmd</code> and press ‘Enter’), input:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -version</span><br></pre></td></tr></table></figure>\n<p>You should see the version information of Java.</p>\n<hr>\n<h2 id=\"4-Welcome-to-the-world-of-Java\"><a href=\"#4-Welcome-to-the-world-of-Java\" class=\"headerlink\" title=\"4. Welcome to the world of Java.\"></a>4. Welcome to the world of Java.</h2>"},{"title":"Make an Interactive Map 02 - \"Let's draw colorful lines!\"","date":"2018-01-31T07:52:54.000Z","_content":"\n#### What is this map?\nThis map shows the change of relations among nodes by time. Well, you can consider it as an airline company which changes its airlines every year.\n\n<iframe width=\"820\" height=\"520\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n#### What tools do you use?\nI still use the same tools as the last blog ([Make an Interactive Map 01](https://brucehenry.github.io/blog/public/2018/01/19/InteractiveMap_01/)): [DataMaps](http://datamaps.github.io/) and [D3](https://d3js.org/).\n\nHowever, this time I largely use d3 to manipulate `svg` elements based on the map. To understand the code, you may need to have some basic knowledge of D3.\n\n---\n#### Show me the code! \nYou can find the code at this [Github repository](https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/02).\n\n##### HTML\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width\">\n    <title>Advanced Interactive Map</title>\n    <link rel=\"stylesheet\" href=\"./advanced_map.css\"/>\n\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"></script>\n</head>\n<body>\n\n<div id=\"map\"></div>\n\n<div id=\"input\">\n    <label for=\"city\">City</label>\n    <select id=\"city\" autocomplete=\"off\">\n        <option disabled selected value> -- select a city --</option>\n    </select>\n\n    <table>\n        <tr>\n            <th rowspan=\"2\">Year</th>\n            <td colspan=\"21\">\n                <label for=\"year\"></label>\n                <input type=\"range\" min=\"2000\" max=\"2018\" step=\"1\" value=\"2000\" autocomplete=\"off\" id=\"year\"/>\n            </td>\n        </tr>\n        <tr>\n            <td>2000</td>\n            <td>2001</td>\n            <td>2002</td>\n            <td>2003</td>\n            <td>2004</td>\n            <td>2005</td>\n            <td>2006</td>\n            <td>2007</td>\n            <td>2008</td>\n            <td>2009</td>\n            <td>2010</td>\n            <td>2011</td>\n            <td>2012</td>\n            <td>2013</td>\n            <td>2014</td>\n            <td>2015</td>\n            <td>2016</td>\n            <td>2017</td>\n            <td>2018</td>\n        </tr>\n    </table>\n    <ul>\n        <li>Try selecting a city (click on the map or use dropdown list).</li>\n        <li>Try dragging the year slider.</li>\n        <li>Try zooming in and dragging the map.</li>\n    </ul>\n</div>\n\n<script src=\"./advanced_map.js\"></script>\n</body>\n</html>\n```\n***\n##### JavaScript\n```javascript\nvar relation_data;//relation data among cities\nvar location_data;//location data of cities\n\n//Get width and height of the outer <div> to set projection\nvar map_div = d3.select('#map').node().getBoundingClientRect();\nvar width = map_div.width, height = map_div.height;\n\n//This values means the initial scale of map, also how much you want the map to zoom in: d3.geo.scale = projection_scale * mouse_event_zoom\nvar projection_scale = 500;\n\n//Projection is a property to set the center and scale of map. Also, we can use it to get position in the map from real world geo coordinates.\nvar projection = d3.geo.equirectangular()\n    .center([-98, 38])//[longitude, latitude]\n    .scale(projection_scale)//Initial scale\n    .translate([width / 2, height / 2]);\n\n//Pop up a box when mouse is over a city\nvar popup = d3.select('body')\n    .append('div')\n    .attr('class', 'popup')\n    .style('opacity', 0);//Invisible\n\n\nfunction renderMap(projection) {\n    //Remove the previous map elements\n    const mapNode = document.getElementById(\"map\");\n    while (mapNode.firstChild) {\n        mapNode.removeChild(mapNode.firstChild);\n    }\n\n    //Render new map\n    new Datamaps({\n        element: document.getElementById('map'),\n        projection: 'mercator',\n        setProjection: function (element) {\n            const path = d3.geo.path().projection(projection);\n            return {path: path, projection: projection};\n        },\n        fills: {\n            defaultFill: '#8ebdee'\n        },\n        geographyConfig: {\n            popupOnHover: false, //disable the popup while hovering\n            highlightOnHover: false\n        }\n    });\n}\n\n//Function to draw circles(cities) on the map.\nfunction drawCity(location_data, projection) {\n    //Remove previous circles\n    d3.select('#circles').remove();\n\n    //Put the data into an array. The parameter of d3.(Select_Function).data() must be iterable.\n    var data = [];\n    for (var city in location_data) {\n        data.push({\n            city: city,\n            location: location_data[city]\n        });\n    }\n\n    //Append all circles into a <g> tag in order to manipulate them easily.\n    var circles = d3.select('svg')\n        .append('g')\n        .attr('id', 'circles')\n        .selectAll('circle');\n\n    //Set attributes and styles of circles based on the data\n    circles.data(data)\n        .enter()\n        .append('circle')\n        .attr('fill', '#ff919f')\n        .attr('r', 4)\n        .attr('cx', function (d) {\n            return projection(d.location)[0];\n        })\n        .attr('cy', function (d) {\n            return projection(d.location)[1];\n        })\n        .on('click', function (d) {\n            if (d3.select(\"#city\").property(\"value\") === d.city)\n                return;\n            d3.select('#city').property('value', d.city);\n            drawLine(relation_data, location_data, projection, 300);\n        })\n        .on('mouseover', function (d) {\n            d3.select(this).attr('r', 7).style('cursor', \"pointer\");\n            popup.style('opacity', .8)\n                .style('left', (d3.event.pageX) + 'px')\n                .style('top', (d3.event.pageY - 20) + 'px')\n                .text(d.city);\n        })\n        .on('mouseout', function () {\n            d3.select(this).attr('r', 4);\n            popup.transition()\n                .duration(500)\n                .style('opacity', 0);\n        });\n}\n\n//Function to draw lines(relations) on the map.\nfunction drawLine(relation_data, location_data, projection, animation_length) {\n    //Remove previous circles\n    d3.select(\"#lines\").remove();\n\n    //Get values from the input\n    var year = d3.select(\"#year\").property(\"value\");\n    var city = d3.select(\"#city\").property(\"value\");\n\n    //If user drag the year slider without selecting any cities, return directly.\n    if (!city)\n        return;\n\n    var data = relation_data[city][year];\n\n    var colorScale = d3.scale.category20();\n\n    //Append all lines into a <g> tag in order to manipulate them easily.\n    var lines = d3.select('svg')\n        .append('g')\n        .attr('id', 'lines')\n        .selectAll('line');\n\n    //Set attributes and styles of lines based on the data\n    lines.data(data)\n        .enter()\n        .append('line')\n        .attr('x1', projection(location_data[city])[0])\n        .attr('y1', projection(location_data[city])[1])\n        .attr('x2', projection(location_data[city])[0])\n        .attr('y2', projection(location_data[city])[1])\n        .style('stroke-width', '3px')\n        .style('stroke', function () {\n            return colorScale(Math.random());\n        })\n        .style('stroke-linecap', 'round')\n        .transition()\n        .duration(animation_length)\n        .attr('x2', function (d) {\n            return projection(location_data[d])[0];\n        })\n        .attr('y2', function (d) {\n            return projection(location_data[d])[1];\n        })\n}\n\n\n//Asynchronously load the data files\nd3.json(\"./city_location.json\", function (city_location) {\n    d3.json(\"./data.json\", function (data) {\n        location_data = city_location;\n        relation_data = data;\n\n        //Append cities into the city selection list\n        var city_selector = d3.select('#city');\n        for (var city in location_data) {\n            city_selector.append('option').text(city);\n        }\n\n        renderMap(projection);//Render the map after loading the data\n        drawCity(location_data, projection);//Draw cities after loading the data\n    });\n});\n\n//Handle zoom (including drag) event\nd3.select('#map').call(\n    d3.behavior.zoom()\n        .scaleExtent([0.5, 5])\n        .on('zoom', function () {\n            //Update projection (projection will be changed after zooming or dragging)\n            projection = d3.geo.equirectangular()\n                .center([-98, 38])\n                .scale(projection_scale * d3.event.scale)\n                .translate([width / 2 + d3.event.translate[0], height / 2 + d3.event.translate[1]]);\n\n            renderMap(projection);\n            drawCity(location_data, projection);\n            drawLine(relation_data, location_data, projection, 0);\n        })\n);\n\n//Handle city selector change\nd3.select(\"#city\").on('change', function () {\n    drawLine(relation_data, location_data, projection, 300);\n});\n\n//Handle year input change\nd3.select(\"#year\").on('input', function () {\n    renderMap(projection);\n    drawCity(location_data, projection);\n    drawLine(relation_data, location_data, projection, 0);\n});\n```\n***\n##### CSS\n```css\n.popup {\n    position: absolute;\n    text-align: center;\n    width: 80px;\n    height: 15px;\n    padding: 2px;\n    font: 12px sans-serif;\n    background: #ebebeb;\n    border: 0;\n    border-radius: 8px;\n    pointer-events: none;\n}\n\n#map {\n    width: 800px;\n    height: 300px;\n    position: relative;\n    margin: auto;\n}\n\n#input {\n    width: 800px;\n    position: relative;\n    margin: auto;\n}\n\nlabel {\n    color: #37ca98;\n    font-size: 20px;\n    font-weight: bold;\n}\n\ntable {\n    width: 100%;\n}\n\nth {\n    color: #e66d18;\n    font-size: 20px;\n    text-align: left;\n}\n\ntr {\n    color: #0026bf;\n    font-size: 12px;\n    font-weight: bold;\n    text-align: center;\n}\n\n#year {\n    -webkit-appearance: none;\n    width: 98%;\n    height: 15px;\n    border-radius: 5px;\n    background: #99ccff;\n    outline: none;\n    opacity: 0.7;\n    -webkit-transition: .2s;\n    transition: opacity .2s;\n}\n\n#year::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-thumb {\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-track {\n    background: none;\n}\n\nul {\n    color: #00242b;\n    font-weight: bold;\n}\n```","source":"_posts/InteractiveMap_02.md","raw":"---\ntitle: Make an Interactive Map 02 - \"Let's draw colorful lines!\"\ndate: 2018-01-31 02:52:54\ncategories:\n- Data Visualization\ntags:\n- JavaScript\n- D3\n---\n\n#### What is this map?\nThis map shows the change of relations among nodes by time. Well, you can consider it as an airline company which changes its airlines every year.\n\n<iframe width=\"820\" height=\"520\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n#### What tools do you use?\nI still use the same tools as the last blog ([Make an Interactive Map 01](https://brucehenry.github.io/blog/public/2018/01/19/InteractiveMap_01/)): [DataMaps](http://datamaps.github.io/) and [D3](https://d3js.org/).\n\nHowever, this time I largely use d3 to manipulate `svg` elements based on the map. To understand the code, you may need to have some basic knowledge of D3.\n\n---\n#### Show me the code! \nYou can find the code at this [Github repository](https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/02).\n\n##### HTML\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width\">\n    <title>Advanced Interactive Map</title>\n    <link rel=\"stylesheet\" href=\"./advanced_map.css\"/>\n\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"></script>\n</head>\n<body>\n\n<div id=\"map\"></div>\n\n<div id=\"input\">\n    <label for=\"city\">City</label>\n    <select id=\"city\" autocomplete=\"off\">\n        <option disabled selected value> -- select a city --</option>\n    </select>\n\n    <table>\n        <tr>\n            <th rowspan=\"2\">Year</th>\n            <td colspan=\"21\">\n                <label for=\"year\"></label>\n                <input type=\"range\" min=\"2000\" max=\"2018\" step=\"1\" value=\"2000\" autocomplete=\"off\" id=\"year\"/>\n            </td>\n        </tr>\n        <tr>\n            <td>2000</td>\n            <td>2001</td>\n            <td>2002</td>\n            <td>2003</td>\n            <td>2004</td>\n            <td>2005</td>\n            <td>2006</td>\n            <td>2007</td>\n            <td>2008</td>\n            <td>2009</td>\n            <td>2010</td>\n            <td>2011</td>\n            <td>2012</td>\n            <td>2013</td>\n            <td>2014</td>\n            <td>2015</td>\n            <td>2016</td>\n            <td>2017</td>\n            <td>2018</td>\n        </tr>\n    </table>\n    <ul>\n        <li>Try selecting a city (click on the map or use dropdown list).</li>\n        <li>Try dragging the year slider.</li>\n        <li>Try zooming in and dragging the map.</li>\n    </ul>\n</div>\n\n<script src=\"./advanced_map.js\"></script>\n</body>\n</html>\n```\n***\n##### JavaScript\n```javascript\nvar relation_data;//relation data among cities\nvar location_data;//location data of cities\n\n//Get width and height of the outer <div> to set projection\nvar map_div = d3.select('#map').node().getBoundingClientRect();\nvar width = map_div.width, height = map_div.height;\n\n//This values means the initial scale of map, also how much you want the map to zoom in: d3.geo.scale = projection_scale * mouse_event_zoom\nvar projection_scale = 500;\n\n//Projection is a property to set the center and scale of map. Also, we can use it to get position in the map from real world geo coordinates.\nvar projection = d3.geo.equirectangular()\n    .center([-98, 38])//[longitude, latitude]\n    .scale(projection_scale)//Initial scale\n    .translate([width / 2, height / 2]);\n\n//Pop up a box when mouse is over a city\nvar popup = d3.select('body')\n    .append('div')\n    .attr('class', 'popup')\n    .style('opacity', 0);//Invisible\n\n\nfunction renderMap(projection) {\n    //Remove the previous map elements\n    const mapNode = document.getElementById(\"map\");\n    while (mapNode.firstChild) {\n        mapNode.removeChild(mapNode.firstChild);\n    }\n\n    //Render new map\n    new Datamaps({\n        element: document.getElementById('map'),\n        projection: 'mercator',\n        setProjection: function (element) {\n            const path = d3.geo.path().projection(projection);\n            return {path: path, projection: projection};\n        },\n        fills: {\n            defaultFill: '#8ebdee'\n        },\n        geographyConfig: {\n            popupOnHover: false, //disable the popup while hovering\n            highlightOnHover: false\n        }\n    });\n}\n\n//Function to draw circles(cities) on the map.\nfunction drawCity(location_data, projection) {\n    //Remove previous circles\n    d3.select('#circles').remove();\n\n    //Put the data into an array. The parameter of d3.(Select_Function).data() must be iterable.\n    var data = [];\n    for (var city in location_data) {\n        data.push({\n            city: city,\n            location: location_data[city]\n        });\n    }\n\n    //Append all circles into a <g> tag in order to manipulate them easily.\n    var circles = d3.select('svg')\n        .append('g')\n        .attr('id', 'circles')\n        .selectAll('circle');\n\n    //Set attributes and styles of circles based on the data\n    circles.data(data)\n        .enter()\n        .append('circle')\n        .attr('fill', '#ff919f')\n        .attr('r', 4)\n        .attr('cx', function (d) {\n            return projection(d.location)[0];\n        })\n        .attr('cy', function (d) {\n            return projection(d.location)[1];\n        })\n        .on('click', function (d) {\n            if (d3.select(\"#city\").property(\"value\") === d.city)\n                return;\n            d3.select('#city').property('value', d.city);\n            drawLine(relation_data, location_data, projection, 300);\n        })\n        .on('mouseover', function (d) {\n            d3.select(this).attr('r', 7).style('cursor', \"pointer\");\n            popup.style('opacity', .8)\n                .style('left', (d3.event.pageX) + 'px')\n                .style('top', (d3.event.pageY - 20) + 'px')\n                .text(d.city);\n        })\n        .on('mouseout', function () {\n            d3.select(this).attr('r', 4);\n            popup.transition()\n                .duration(500)\n                .style('opacity', 0);\n        });\n}\n\n//Function to draw lines(relations) on the map.\nfunction drawLine(relation_data, location_data, projection, animation_length) {\n    //Remove previous circles\n    d3.select(\"#lines\").remove();\n\n    //Get values from the input\n    var year = d3.select(\"#year\").property(\"value\");\n    var city = d3.select(\"#city\").property(\"value\");\n\n    //If user drag the year slider without selecting any cities, return directly.\n    if (!city)\n        return;\n\n    var data = relation_data[city][year];\n\n    var colorScale = d3.scale.category20();\n\n    //Append all lines into a <g> tag in order to manipulate them easily.\n    var lines = d3.select('svg')\n        .append('g')\n        .attr('id', 'lines')\n        .selectAll('line');\n\n    //Set attributes and styles of lines based on the data\n    lines.data(data)\n        .enter()\n        .append('line')\n        .attr('x1', projection(location_data[city])[0])\n        .attr('y1', projection(location_data[city])[1])\n        .attr('x2', projection(location_data[city])[0])\n        .attr('y2', projection(location_data[city])[1])\n        .style('stroke-width', '3px')\n        .style('stroke', function () {\n            return colorScale(Math.random());\n        })\n        .style('stroke-linecap', 'round')\n        .transition()\n        .duration(animation_length)\n        .attr('x2', function (d) {\n            return projection(location_data[d])[0];\n        })\n        .attr('y2', function (d) {\n            return projection(location_data[d])[1];\n        })\n}\n\n\n//Asynchronously load the data files\nd3.json(\"./city_location.json\", function (city_location) {\n    d3.json(\"./data.json\", function (data) {\n        location_data = city_location;\n        relation_data = data;\n\n        //Append cities into the city selection list\n        var city_selector = d3.select('#city');\n        for (var city in location_data) {\n            city_selector.append('option').text(city);\n        }\n\n        renderMap(projection);//Render the map after loading the data\n        drawCity(location_data, projection);//Draw cities after loading the data\n    });\n});\n\n//Handle zoom (including drag) event\nd3.select('#map').call(\n    d3.behavior.zoom()\n        .scaleExtent([0.5, 5])\n        .on('zoom', function () {\n            //Update projection (projection will be changed after zooming or dragging)\n            projection = d3.geo.equirectangular()\n                .center([-98, 38])\n                .scale(projection_scale * d3.event.scale)\n                .translate([width / 2 + d3.event.translate[0], height / 2 + d3.event.translate[1]]);\n\n            renderMap(projection);\n            drawCity(location_data, projection);\n            drawLine(relation_data, location_data, projection, 0);\n        })\n);\n\n//Handle city selector change\nd3.select(\"#city\").on('change', function () {\n    drawLine(relation_data, location_data, projection, 300);\n});\n\n//Handle year input change\nd3.select(\"#year\").on('input', function () {\n    renderMap(projection);\n    drawCity(location_data, projection);\n    drawLine(relation_data, location_data, projection, 0);\n});\n```\n***\n##### CSS\n```css\n.popup {\n    position: absolute;\n    text-align: center;\n    width: 80px;\n    height: 15px;\n    padding: 2px;\n    font: 12px sans-serif;\n    background: #ebebeb;\n    border: 0;\n    border-radius: 8px;\n    pointer-events: none;\n}\n\n#map {\n    width: 800px;\n    height: 300px;\n    position: relative;\n    margin: auto;\n}\n\n#input {\n    width: 800px;\n    position: relative;\n    margin: auto;\n}\n\nlabel {\n    color: #37ca98;\n    font-size: 20px;\n    font-weight: bold;\n}\n\ntable {\n    width: 100%;\n}\n\nth {\n    color: #e66d18;\n    font-size: 20px;\n    text-align: left;\n}\n\ntr {\n    color: #0026bf;\n    font-size: 12px;\n    font-weight: bold;\n    text-align: center;\n}\n\n#year {\n    -webkit-appearance: none;\n    width: 98%;\n    height: 15px;\n    border-radius: 5px;\n    background: #99ccff;\n    outline: none;\n    opacity: 0.7;\n    -webkit-transition: .2s;\n    transition: opacity .2s;\n}\n\n#year::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-thumb {\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-track {\n    background: none;\n}\n\nul {\n    color: #00242b;\n    font-weight: bold;\n}\n```","slug":"InteractiveMap_02","published":1,"updated":"2018-02-15T04:28:05.534Z","_id":"cjdmw73ep0000lsunohqe2x06","comments":1,"layout":"post","photos":[],"link":"","content":"<h4 id=\"What-is-this-map\"><a href=\"#What-is-this-map\" class=\"headerlink\" title=\"What is this map?\"></a>What is this map?</h4><p>This map shows the change of relations among nodes by time. Well, you can consider it as an airline company which changes its airlines every year.</p>\n<iframe width=\"820\" height=\"520\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n<h4 id=\"What-tools-do-you-use\"><a href=\"#What-tools-do-you-use\" class=\"headerlink\" title=\"What tools do you use?\"></a>What tools do you use?</h4><p>I still use the same tools as the last blog (<a href=\"https://brucehenry.github.io/blog/public/2018/01/19/InteractiveMap_01/\">Make an Interactive Map 01</a>): <a href=\"http://datamaps.github.io/\" target=\"_blank\" rel=\"noopener\">DataMaps</a> and <a href=\"https://d3js.org/\" target=\"_blank\" rel=\"noopener\">D3</a>.</p>\n<p>However, this time I largely use d3 to manipulate <code>svg</code> elements based on the map. To understand the code, you may need to have some basic knowledge of D3.</p>\n<hr>\n<h4 id=\"Show-me-the-code\"><a href=\"#Show-me-the-code\" class=\"headerlink\" title=\"Show me the code!\"></a>Show me the code!</h4><p>You can find the code at this <a href=\"https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/02\" target=\"_blank\" rel=\"noopener\">Github repository</a>.</p>\n<h5 id=\"HTML\"><a href=\"#HTML\" class=\"headerlink\" title=\"HTML\"></a>HTML</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Advanced Interactive Map<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"./advanced_map.css\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"input\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"city\"</span>&gt;</span>City<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"city\"</span> <span class=\"attr\">autocomplete</span>=<span class=\"string\">\"off\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">disabled</span> <span class=\"attr\">selected</span> <span class=\"attr\">value</span>&gt;</span> -- select a city --<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">th</span> <span class=\"attr\">rowspan</span>=<span class=\"string\">\"2\"</span>&gt;</span>Year<span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">colspan</span>=<span class=\"string\">\"21\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"year\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"range\"</span> <span class=\"attr\">min</span>=<span class=\"string\">\"2000\"</span> <span class=\"attr\">max</span>=<span class=\"string\">\"2018\"</span> <span class=\"attr\">step</span>=<span class=\"string\">\"1\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"2000\"</span> <span class=\"attr\">autocomplete</span>=<span class=\"string\">\"off\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"year\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2000<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2001<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2002<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2003<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2004<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2005<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2006<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2007<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2008<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2009<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2010<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2011<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2012<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2013<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2014<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2015<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2016<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2017<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2018<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try selecting a city (click on the map or use dropdown list).<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try dragging the year slider.<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try zooming in and dragging the map.<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./advanced_map.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"JavaScript\"><a href=\"#JavaScript\" class=\"headerlink\" title=\"JavaScript\"></a>JavaScript</h5><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> relation_data;<span class=\"comment\">//relation data among cities</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> location_data;<span class=\"comment\">//location data of cities</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Get width and height of the outer &lt;div&gt; to set projection</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> map_div = d3.select(<span class=\"string\">'#map'</span>).node().getBoundingClientRect();</span><br><span class=\"line\"><span class=\"keyword\">var</span> width = map_div.width, height = map_div.height;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//This values means the initial scale of map, also how much you want the map to zoom in: d3.geo.scale = projection_scale * mouse_event_zoom</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> projection_scale = <span class=\"number\">500</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Projection is a property to set the center and scale of map. Also, we can use it to get position in the map from real world geo coordinates.</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> projection = d3.geo.equirectangular()</span><br><span class=\"line\">    .center([<span class=\"number\">-98</span>, <span class=\"number\">38</span>])<span class=\"comment\">//[longitude, latitude]</span></span><br><span class=\"line\">    .scale(projection_scale)<span class=\"comment\">//Initial scale</span></span><br><span class=\"line\">    .translate([width / <span class=\"number\">2</span>, height / <span class=\"number\">2</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Pop up a box when mouse is over a city</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> popup = d3.select(<span class=\"string\">'body'</span>)</span><br><span class=\"line\">    .append(<span class=\"string\">'div'</span>)</span><br><span class=\"line\">    .attr(<span class=\"string\">'class'</span>, <span class=\"string\">'popup'</span>)</span><br><span class=\"line\">    .style(<span class=\"string\">'opacity'</span>, <span class=\"number\">0</span>);<span class=\"comment\">//Invisible</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">renderMap</span>(<span class=\"params\">projection</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove the previous map elements</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> mapNode = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">\"map\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (mapNode.firstChild) &#123;</span><br><span class=\"line\">        mapNode.removeChild(mapNode.firstChild);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Render new map</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> Datamaps(&#123;</span><br><span class=\"line\">        element: <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'map'</span>),</span><br><span class=\"line\">        projection: <span class=\"string\">'mercator'</span>,</span><br><span class=\"line\">        setProjection: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> path = d3.geo.path().projection(projection);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"attr\">path</span>: path, <span class=\"attr\">projection</span>: projection&#125;;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        fills: &#123;</span><br><span class=\"line\">            defaultFill: <span class=\"string\">'#8ebdee'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        geographyConfig: &#123;</span><br><span class=\"line\">            popupOnHover: <span class=\"literal\">false</span>, <span class=\"comment\">//disable the popup while hovering</span></span><br><span class=\"line\">            highlightOnHover: <span class=\"literal\">false</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Function to draw circles(cities) on the map.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">drawCity</span>(<span class=\"params\">location_data, projection</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove previous circles</span></span><br><span class=\"line\">    d3.select(<span class=\"string\">'#circles'</span>).remove();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Put the data into an array. The parameter of d3.(Select_Function).data() must be iterable.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = [];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> city <span class=\"keyword\">in</span> location_data) &#123;</span><br><span class=\"line\">        data.push(&#123;</span><br><span class=\"line\">            city: city,</span><br><span class=\"line\">            location: location_data[city]</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Append all circles into a &lt;g&gt; tag in order to manipulate them easily.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> circles = d3.select(<span class=\"string\">'svg'</span>)</span><br><span class=\"line\">        .append(<span class=\"string\">'g'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'id'</span>, <span class=\"string\">'circles'</span>)</span><br><span class=\"line\">        .selectAll(<span class=\"string\">'circle'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Set attributes and styles of circles based on the data</span></span><br><span class=\"line\">    circles.data(data)</span><br><span class=\"line\">        .enter()</span><br><span class=\"line\">        .append(<span class=\"string\">'circle'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'fill'</span>, <span class=\"string\">'#ff919f'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'r'</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'cx'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(d.location)[<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .attr(<span class=\"string\">'cy'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(d.location)[<span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'click'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>) === d.city)</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            d3.select(<span class=\"string\">'#city'</span>).property(<span class=\"string\">'value'</span>, d.city);</span><br><span class=\"line\">            drawLine(relation_data, location_data, projection, <span class=\"number\">300</span>);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'mouseover'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            d3.select(<span class=\"keyword\">this</span>).attr(<span class=\"string\">'r'</span>, <span class=\"number\">7</span>).style(<span class=\"string\">'cursor'</span>, <span class=\"string\">\"pointer\"</span>);</span><br><span class=\"line\">            popup.style(<span class=\"string\">'opacity'</span>, <span class=\"number\">.8</span>)</span><br><span class=\"line\">                .style(<span class=\"string\">'left'</span>, (d3.event.pageX) + <span class=\"string\">'px'</span>)</span><br><span class=\"line\">                .style(<span class=\"string\">'top'</span>, (d3.event.pageY - <span class=\"number\">20</span>) + <span class=\"string\">'px'</span>)</span><br><span class=\"line\">                .text(d.city);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'mouseout'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            d3.select(<span class=\"keyword\">this</span>).attr(<span class=\"string\">'r'</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">            popup.transition()</span><br><span class=\"line\">                .duration(<span class=\"number\">500</span>)</span><br><span class=\"line\">                .style(<span class=\"string\">'opacity'</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Function to draw lines(relations) on the map.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">drawLine</span>(<span class=\"params\">relation_data, location_data, projection, animation_length</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove previous circles</span></span><br><span class=\"line\">    d3.select(<span class=\"string\">\"#lines\"</span>).remove();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Get values from the input</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = d3.select(<span class=\"string\">\"#year\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> city = d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//If user drag the year slider without selecting any cities, return directly.</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!city)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = relation_data[city][year];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> colorScale = d3.scale.category20();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Append all lines into a &lt;g&gt; tag in order to manipulate them easily.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> lines = d3.select(<span class=\"string\">'svg'</span>)</span><br><span class=\"line\">        .append(<span class=\"string\">'g'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'id'</span>, <span class=\"string\">'lines'</span>)</span><br><span class=\"line\">        .selectAll(<span class=\"string\">'line'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Set attributes and styles of lines based on the data</span></span><br><span class=\"line\">    lines.data(data)</span><br><span class=\"line\">        .enter()</span><br><span class=\"line\">        .append(<span class=\"string\">'line'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'x1'</span>, projection(location_data[city])[<span class=\"number\">0</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'y1'</span>, projection(location_data[city])[<span class=\"number\">1</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'x2'</span>, projection(location_data[city])[<span class=\"number\">0</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'y2'</span>, projection(location_data[city])[<span class=\"number\">1</span>])</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke-width'</span>, <span class=\"string\">'3px'</span>)</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> colorScale(<span class=\"built_in\">Math</span>.random());</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke-linecap'</span>, <span class=\"string\">'round'</span>)</span><br><span class=\"line\">        .transition()</span><br><span class=\"line\">        .duration(animation_length)</span><br><span class=\"line\">        .attr(<span class=\"string\">'x2'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(location_data[d])[<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .attr(<span class=\"string\">'y2'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(location_data[d])[<span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Asynchronously load the data files</span></span><br><span class=\"line\">d3.json(<span class=\"string\">\"./city_location.json\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">city_location</span>) </span>&#123;</span><br><span class=\"line\">    d3.json(<span class=\"string\">\"./data.json\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">        location_data = city_location;</span><br><span class=\"line\">        relation_data = data;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//Append cities into the city selection list</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> city_selector = d3.select(<span class=\"string\">'#city'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> city <span class=\"keyword\">in</span> location_data) &#123;</span><br><span class=\"line\">            city_selector.append(<span class=\"string\">'option'</span>).text(city);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        renderMap(projection);<span class=\"comment\">//Render the map after loading the data</span></span><br><span class=\"line\">        drawCity(location_data, projection);<span class=\"comment\">//Draw cities after loading the data</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle zoom (including drag) event</span></span><br><span class=\"line\">d3.select(<span class=\"string\">'#map'</span>).call(</span><br><span class=\"line\">    d3.behavior.zoom()</span><br><span class=\"line\">        .scaleExtent([<span class=\"number\">0.5</span>, <span class=\"number\">5</span>])</span><br><span class=\"line\">        .on(<span class=\"string\">'zoom'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">//Update projection (projection will be changed after zooming or dragging)</span></span><br><span class=\"line\">            projection = d3.geo.equirectangular()</span><br><span class=\"line\">                .center([<span class=\"number\">-98</span>, <span class=\"number\">38</span>])</span><br><span class=\"line\">                .scale(projection_scale * d3.event.scale)</span><br><span class=\"line\">                .translate([width / <span class=\"number\">2</span> + d3.event.translate[<span class=\"number\">0</span>], height / <span class=\"number\">2</span> + d3.event.translate[<span class=\"number\">1</span>]]);</span><br><span class=\"line\"></span><br><span class=\"line\">            renderMap(projection);</span><br><span class=\"line\">            drawCity(location_data, projection);</span><br><span class=\"line\">            drawLine(relation_data, location_data, projection, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle city selector change</span></span><br><span class=\"line\">d3.select(<span class=\"string\">\"#city\"</span>).on(<span class=\"string\">'change'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    drawLine(relation_data, location_data, projection, <span class=\"number\">300</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle year input change</span></span><br><span class=\"line\">d3.select(<span class=\"string\">\"#year\"</span>).on(<span class=\"string\">'input'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    renderMap(projection);</span><br><span class=\"line\">    drawCity(location_data, projection);</span><br><span class=\"line\">    drawLine(relation_data, location_data, projection, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"CSS\"><a href=\"#CSS\" class=\"headerlink\" title=\"CSS\"></a>CSS</h5><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.popup</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">2px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font</span>: <span class=\"number\">12px</span> sans-serif;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#ebebeb</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">8px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">pointer-events</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#map</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#input</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">label</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#37ca98</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">table</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">th</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#e66d18</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: left;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">tr</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#0026bf</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">12px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">98%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#99ccff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">outline</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: <span class=\"number\">0.7</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-transition</span>: .<span class=\"number\">2s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: opacity .<span class=\"number\">2s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-webkit-slider-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-track</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">ul</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#00242b</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"What-is-this-map\"><a href=\"#What-is-this-map\" class=\"headerlink\" title=\"What is this map?\"></a>What is this map?</h4><p>This map shows the change of relations among nodes by time. Well, you can consider it as an airline company which changes its airlines every year.</p>\n<iframe width=\"820\" height=\"520\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n<h4 id=\"What-tools-do-you-use\"><a href=\"#What-tools-do-you-use\" class=\"headerlink\" title=\"What tools do you use?\"></a>What tools do you use?</h4><p>I still use the same tools as the last blog (<a href=\"https://brucehenry.github.io/blog/public/2018/01/19/InteractiveMap_01/\">Make an Interactive Map 01</a>): <a href=\"http://datamaps.github.io/\" target=\"_blank\" rel=\"noopener\">DataMaps</a> and <a href=\"https://d3js.org/\" target=\"_blank\" rel=\"noopener\">D3</a>.</p>\n<p>However, this time I largely use d3 to manipulate <code>svg</code> elements based on the map. To understand the code, you may need to have some basic knowledge of D3.</p>\n<hr>\n<h4 id=\"Show-me-the-code\"><a href=\"#Show-me-the-code\" class=\"headerlink\" title=\"Show me the code!\"></a>Show me the code!</h4><p>You can find the code at this <a href=\"https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/02\" target=\"_blank\" rel=\"noopener\">Github repository</a>.</p>\n<h5 id=\"HTML\"><a href=\"#HTML\" class=\"headerlink\" title=\"HTML\"></a>HTML</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Advanced Interactive Map<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"./advanced_map.css\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"input\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"city\"</span>&gt;</span>City<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"city\"</span> <span class=\"attr\">autocomplete</span>=<span class=\"string\">\"off\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">disabled</span> <span class=\"attr\">selected</span> <span class=\"attr\">value</span>&gt;</span> -- select a city --<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">th</span> <span class=\"attr\">rowspan</span>=<span class=\"string\">\"2\"</span>&gt;</span>Year<span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">colspan</span>=<span class=\"string\">\"21\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"year\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"range\"</span> <span class=\"attr\">min</span>=<span class=\"string\">\"2000\"</span> <span class=\"attr\">max</span>=<span class=\"string\">\"2018\"</span> <span class=\"attr\">step</span>=<span class=\"string\">\"1\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"2000\"</span> <span class=\"attr\">autocomplete</span>=<span class=\"string\">\"off\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"year\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2000<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2001<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2002<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2003<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2004<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2005<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2006<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2007<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2008<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2009<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2010<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2011<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2012<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2013<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2014<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2015<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2016<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2017<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2018<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try selecting a city (click on the map or use dropdown list).<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try dragging the year slider.<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try zooming in and dragging the map.<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./advanced_map.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"JavaScript\"><a href=\"#JavaScript\" class=\"headerlink\" title=\"JavaScript\"></a>JavaScript</h5><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> relation_data;<span class=\"comment\">//relation data among cities</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> location_data;<span class=\"comment\">//location data of cities</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Get width and height of the outer &lt;div&gt; to set projection</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> map_div = d3.select(<span class=\"string\">'#map'</span>).node().getBoundingClientRect();</span><br><span class=\"line\"><span class=\"keyword\">var</span> width = map_div.width, height = map_div.height;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//This values means the initial scale of map, also how much you want the map to zoom in: d3.geo.scale = projection_scale * mouse_event_zoom</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> projection_scale = <span class=\"number\">500</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Projection is a property to set the center and scale of map. Also, we can use it to get position in the map from real world geo coordinates.</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> projection = d3.geo.equirectangular()</span><br><span class=\"line\">    .center([<span class=\"number\">-98</span>, <span class=\"number\">38</span>])<span class=\"comment\">//[longitude, latitude]</span></span><br><span class=\"line\">    .scale(projection_scale)<span class=\"comment\">//Initial scale</span></span><br><span class=\"line\">    .translate([width / <span class=\"number\">2</span>, height / <span class=\"number\">2</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Pop up a box when mouse is over a city</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> popup = d3.select(<span class=\"string\">'body'</span>)</span><br><span class=\"line\">    .append(<span class=\"string\">'div'</span>)</span><br><span class=\"line\">    .attr(<span class=\"string\">'class'</span>, <span class=\"string\">'popup'</span>)</span><br><span class=\"line\">    .style(<span class=\"string\">'opacity'</span>, <span class=\"number\">0</span>);<span class=\"comment\">//Invisible</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">renderMap</span>(<span class=\"params\">projection</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove the previous map elements</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> mapNode = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">\"map\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (mapNode.firstChild) &#123;</span><br><span class=\"line\">        mapNode.removeChild(mapNode.firstChild);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Render new map</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> Datamaps(&#123;</span><br><span class=\"line\">        element: <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'map'</span>),</span><br><span class=\"line\">        projection: <span class=\"string\">'mercator'</span>,</span><br><span class=\"line\">        setProjection: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> path = d3.geo.path().projection(projection);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"attr\">path</span>: path, <span class=\"attr\">projection</span>: projection&#125;;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        fills: &#123;</span><br><span class=\"line\">            defaultFill: <span class=\"string\">'#8ebdee'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        geographyConfig: &#123;</span><br><span class=\"line\">            popupOnHover: <span class=\"literal\">false</span>, <span class=\"comment\">//disable the popup while hovering</span></span><br><span class=\"line\">            highlightOnHover: <span class=\"literal\">false</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Function to draw circles(cities) on the map.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">drawCity</span>(<span class=\"params\">location_data, projection</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove previous circles</span></span><br><span class=\"line\">    d3.select(<span class=\"string\">'#circles'</span>).remove();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Put the data into an array. The parameter of d3.(Select_Function).data() must be iterable.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = [];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> city <span class=\"keyword\">in</span> location_data) &#123;</span><br><span class=\"line\">        data.push(&#123;</span><br><span class=\"line\">            city: city,</span><br><span class=\"line\">            location: location_data[city]</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Append all circles into a &lt;g&gt; tag in order to manipulate them easily.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> circles = d3.select(<span class=\"string\">'svg'</span>)</span><br><span class=\"line\">        .append(<span class=\"string\">'g'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'id'</span>, <span class=\"string\">'circles'</span>)</span><br><span class=\"line\">        .selectAll(<span class=\"string\">'circle'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Set attributes and styles of circles based on the data</span></span><br><span class=\"line\">    circles.data(data)</span><br><span class=\"line\">        .enter()</span><br><span class=\"line\">        .append(<span class=\"string\">'circle'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'fill'</span>, <span class=\"string\">'#ff919f'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'r'</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'cx'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(d.location)[<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .attr(<span class=\"string\">'cy'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(d.location)[<span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'click'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>) === d.city)</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            d3.select(<span class=\"string\">'#city'</span>).property(<span class=\"string\">'value'</span>, d.city);</span><br><span class=\"line\">            drawLine(relation_data, location_data, projection, <span class=\"number\">300</span>);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'mouseover'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            d3.select(<span class=\"keyword\">this</span>).attr(<span class=\"string\">'r'</span>, <span class=\"number\">7</span>).style(<span class=\"string\">'cursor'</span>, <span class=\"string\">\"pointer\"</span>);</span><br><span class=\"line\">            popup.style(<span class=\"string\">'opacity'</span>, <span class=\"number\">.8</span>)</span><br><span class=\"line\">                .style(<span class=\"string\">'left'</span>, (d3.event.pageX) + <span class=\"string\">'px'</span>)</span><br><span class=\"line\">                .style(<span class=\"string\">'top'</span>, (d3.event.pageY - <span class=\"number\">20</span>) + <span class=\"string\">'px'</span>)</span><br><span class=\"line\">                .text(d.city);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'mouseout'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            d3.select(<span class=\"keyword\">this</span>).attr(<span class=\"string\">'r'</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">            popup.transition()</span><br><span class=\"line\">                .duration(<span class=\"number\">500</span>)</span><br><span class=\"line\">                .style(<span class=\"string\">'opacity'</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Function to draw lines(relations) on the map.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">drawLine</span>(<span class=\"params\">relation_data, location_data, projection, animation_length</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove previous circles</span></span><br><span class=\"line\">    d3.select(<span class=\"string\">\"#lines\"</span>).remove();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Get values from the input</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = d3.select(<span class=\"string\">\"#year\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> city = d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//If user drag the year slider without selecting any cities, return directly.</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!city)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = relation_data[city][year];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> colorScale = d3.scale.category20();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Append all lines into a &lt;g&gt; tag in order to manipulate them easily.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> lines = d3.select(<span class=\"string\">'svg'</span>)</span><br><span class=\"line\">        .append(<span class=\"string\">'g'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'id'</span>, <span class=\"string\">'lines'</span>)</span><br><span class=\"line\">        .selectAll(<span class=\"string\">'line'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Set attributes and styles of lines based on the data</span></span><br><span class=\"line\">    lines.data(data)</span><br><span class=\"line\">        .enter()</span><br><span class=\"line\">        .append(<span class=\"string\">'line'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'x1'</span>, projection(location_data[city])[<span class=\"number\">0</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'y1'</span>, projection(location_data[city])[<span class=\"number\">1</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'x2'</span>, projection(location_data[city])[<span class=\"number\">0</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'y2'</span>, projection(location_data[city])[<span class=\"number\">1</span>])</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke-width'</span>, <span class=\"string\">'3px'</span>)</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> colorScale(<span class=\"built_in\">Math</span>.random());</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke-linecap'</span>, <span class=\"string\">'round'</span>)</span><br><span class=\"line\">        .transition()</span><br><span class=\"line\">        .duration(animation_length)</span><br><span class=\"line\">        .attr(<span class=\"string\">'x2'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(location_data[d])[<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .attr(<span class=\"string\">'y2'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(location_data[d])[<span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Asynchronously load the data files</span></span><br><span class=\"line\">d3.json(<span class=\"string\">\"./city_location.json\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">city_location</span>) </span>&#123;</span><br><span class=\"line\">    d3.json(<span class=\"string\">\"./data.json\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">        location_data = city_location;</span><br><span class=\"line\">        relation_data = data;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//Append cities into the city selection list</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> city_selector = d3.select(<span class=\"string\">'#city'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> city <span class=\"keyword\">in</span> location_data) &#123;</span><br><span class=\"line\">            city_selector.append(<span class=\"string\">'option'</span>).text(city);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        renderMap(projection);<span class=\"comment\">//Render the map after loading the data</span></span><br><span class=\"line\">        drawCity(location_data, projection);<span class=\"comment\">//Draw cities after loading the data</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle zoom (including drag) event</span></span><br><span class=\"line\">d3.select(<span class=\"string\">'#map'</span>).call(</span><br><span class=\"line\">    d3.behavior.zoom()</span><br><span class=\"line\">        .scaleExtent([<span class=\"number\">0.5</span>, <span class=\"number\">5</span>])</span><br><span class=\"line\">        .on(<span class=\"string\">'zoom'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">//Update projection (projection will be changed after zooming or dragging)</span></span><br><span class=\"line\">            projection = d3.geo.equirectangular()</span><br><span class=\"line\">                .center([<span class=\"number\">-98</span>, <span class=\"number\">38</span>])</span><br><span class=\"line\">                .scale(projection_scale * d3.event.scale)</span><br><span class=\"line\">                .translate([width / <span class=\"number\">2</span> + d3.event.translate[<span class=\"number\">0</span>], height / <span class=\"number\">2</span> + d3.event.translate[<span class=\"number\">1</span>]]);</span><br><span class=\"line\"></span><br><span class=\"line\">            renderMap(projection);</span><br><span class=\"line\">            drawCity(location_data, projection);</span><br><span class=\"line\">            drawLine(relation_data, location_data, projection, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle city selector change</span></span><br><span class=\"line\">d3.select(<span class=\"string\">\"#city\"</span>).on(<span class=\"string\">'change'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    drawLine(relation_data, location_data, projection, <span class=\"number\">300</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle year input change</span></span><br><span class=\"line\">d3.select(<span class=\"string\">\"#year\"</span>).on(<span class=\"string\">'input'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    renderMap(projection);</span><br><span class=\"line\">    drawCity(location_data, projection);</span><br><span class=\"line\">    drawLine(relation_data, location_data, projection, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"CSS\"><a href=\"#CSS\" class=\"headerlink\" title=\"CSS\"></a>CSS</h5><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.popup</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">2px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font</span>: <span class=\"number\">12px</span> sans-serif;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#ebebeb</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">8px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">pointer-events</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#map</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#input</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">label</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#37ca98</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">table</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">th</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#e66d18</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: left;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">tr</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#0026bf</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">12px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">98%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#99ccff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">outline</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: <span class=\"number\">0.7</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-transition</span>: .<span class=\"number\">2s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: opacity .<span class=\"number\">2s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-webkit-slider-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-track</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">ul</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#00242b</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Make an Interactive Map 03 - \"Let's make beautiful charts!\"","date":"2018-02-05T07:52:54.000Z","_content":"#### Introduction\nThis visualization extends from my last blog [Make an Interactive Map 02 - \"Let's draw colorful lines!\"](https://brucehenry.github.io/blog/public/2018/01/31/InteractiveMap_02/). Most of the code remains the same.\n\nI add some charts which are able to show some detailed data beyond the map.\nTo generate the charts, I used [echarts](https://ecomfe.github.io/echarts-doc/public/en/index.html) which is an excellent data visualization tool from Baidu.\n\nAnyway, what I want to say is that you can add some other elements into the data visualization page combined with the map instead of adding too much elements into the map.\n\nLet's first see how it looks,\n<iframe width=\"820\" height=\"1060\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/03/map_with_chart.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n#### About Echarts\nInstead of making charts use D3, I choose to use echarts.\n\nBecause the colors and styles are already well designed, I can focus more on something else.\n\nAnd furthermore, it is totally free.\n\n#### Code\n\nYou can find the code at this [Github repository](https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/03).\n\n##### HTML\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width\">\n    <title>Advanced Interactive Map</title>\n    <link rel=\"stylesheet\" href=\"./map_with_chart.css\"/>\n\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"></script>\n</head>\n<body>\n\n<div id=\"map\"></div>\n\n<div id=\"input\">\n    <label for=\"city\">City</label>\n    <select id=\"city\" autocomplete=\"off\"></select>\n\n    <table>\n        <tr>\n            <th rowspan=\"2\">Year</th>\n            <td colspan=\"21\">\n                <label for=\"year\"></label>\n                <input type=\"range\" min=\"2000\" max=\"2018\" step=\"1\" value=\"2000\" autocomplete=\"off\" id=\"year\"/>\n            </td>\n        </tr>\n        <tr>\n            <td>2000</td>\n            <td>2001</td>\n            <td>2002</td>\n            <td>2003</td>\n            <td>2004</td>\n            <td>2005</td>\n            <td>2006</td>\n            <td>2007</td>\n            <td>2008</td>\n            <td>2009</td>\n            <td>2010</td>\n            <td>2011</td>\n            <td>2012</td>\n            <td>2013</td>\n            <td>2014</td>\n            <td>2015</td>\n            <td>2016</td>\n            <td>2017</td>\n            <td>2018</td>\n        </tr>\n    </table>\n    <ul>\n        <li>Try selecting a city (click on the map or use dropdown list).</li>\n        <li>Try dragging the year slider.</li>\n        <li>Try zooming in and dragging the map.</li>\n    </ul>\n</div>\n\n<div id=\"pie\"></div>\n<div id=\"line\"></div>\n\n<script src=\"./echarts.min.js\"></script>\n<script src=\"./map_with_chart.js\"></script>\n</body>\n</html>\n```\n***\n##### JavaScript\n```javascript\nvar relation_data;//relation data among cities\nvar location_data;//location data of cities\n\n//Get width and height of the outer <div> to set projection\nvar map_div = d3.select('#map').node().getBoundingClientRect();\nvar width = map_div.width, height = map_div.height;\n\n//This values means the initial scale of map, also how much you want the map to zoom in: d3.geo.scale = projection_scale * mouse_event_zoom\nvar projection_scale = 500;\n\n//Projection is a property to set the center and scale of map. Also, we can use it to get position in the map from real world geo coordinates.\nvar projection = d3.geo.equirectangular()\n    .center([-98, 38])//[longitude, latitude]\n    .scale(projection_scale)//Initial scale\n    .translate([width / 2, height / 2]);\n\n//Pop up a box when mouse is over a city\nvar popup = d3.select('body')\n    .append('div')\n    .attr('class', 'popup')\n    .style('opacity', 0);//Invisible\n\n\nfunction renderMap(projection) {\n    //Remove the previous map elements\n    const mapNode = document.getElementById(\"map\");\n    while (mapNode.firstChild) {\n        mapNode.removeChild(mapNode.firstChild);\n    }\n\n    //Render new map\n    new Datamaps({\n        element: document.getElementById('map'),\n        projection: 'mercator',\n        setProjection: function (element) {\n            const path = d3.geo.path().projection(projection);\n            return {path: path, projection: projection};\n        },\n        fills: {\n            defaultFill: '#8ebdee'\n        },\n        geographyConfig: {\n            popupOnHover: false, //disable the popup while hovering\n            highlightOnHover: false\n        }\n    });\n}\n\n//Function to draw circles(cities) on the map.\nfunction drawCity(location_data, projection) {\n    //Remove previous circles\n    d3.select('#circles').remove();\n\n    //Put the data into an array. The parameter of d3.(Select_Function).data() must be iterable.\n    var data = [];\n    for (var city in location_data) {\n        data.push({\n            city: city,\n            location: location_data[city]\n        });\n    }\n\n    //Append all circles into a <g> tag in order to manipulate them easily.\n    var circles = d3.select('svg')\n        .append('g')\n        .attr('id', 'circles')\n        .selectAll('circle');\n\n    //Set attributes and styles of circles based on the data\n    circles.data(data)\n        .enter()\n        .append('circle')\n        .attr('fill', '#ff919f')\n        .attr('r', 4)\n        .attr('cx', function (d) {\n            return projection(d.location)[0];\n        })\n        .attr('cy', function (d) {\n            return projection(d.location)[1];\n        })\n        .on('click', function (d) {\n            if (d3.select(\"#city\").property(\"value\") === d.city)\n                return;\n            d3.select('#city').property('value', d.city);\n            drawLine(relation_data, location_data, projection, 300);\n            renderPieChart(relation_data);\n            renderLineChart(relation_data);\n        })\n        .on('mouseover', function (d) {\n            d3.select(this).attr('r', 7).style('cursor', \"pointer\");\n            popup.style('opacity', .8)\n                .style('left', (d3.event.pageX) + 'px')\n                .style('top', (d3.event.pageY - 20) + 'px')\n                .text(d.city);\n        })\n        .on('mouseout', function () {\n            d3.select(this).attr('r', 4);\n            popup.transition()\n                .style('opacity', 0);\n        });\n}\n\n//Function to draw lines(relations) on the map.\nfunction drawLine(relation_data, location_data, projection, animation_length) {\n    //Remove previous circles\n    d3.select(\"#lines\").remove();\n\n    //Get values from the input\n    var year = d3.select(\"#year\").property(\"value\");\n    var city = d3.select(\"#city\").property(\"value\");\n\n    var data = relation_data[city][year];\n\n    var colorScale = d3.scale.category20();\n\n    //Append all lines into a <g> tag in order to manipulate them easily.\n    var lines = d3.select('svg')\n        .append('g')\n        .attr('id', 'lines')\n        .selectAll('line');\n\n    //Set attributes and styles of lines based on the data\n    lines.data(data)\n        .enter()\n        .append('line')\n        .attr('x1', projection(location_data[city])[0])\n        .attr('y1', projection(location_data[city])[1])\n        .attr('x2', projection(location_data[city])[0])\n        .attr('y2', projection(location_data[city])[1])\n        .style('stroke-width', '3px')\n        .style('stroke', function () {\n            return colorScale(Math.random());\n        })\n        .style('stroke-linecap', 'round')\n        .transition()\n        .duration(animation_length)\n        .attr('x2', function (d) {\n            return projection(location_data[d])[0];\n        })\n        .attr('y2', function (d) {\n            return projection(location_data[d])[1];\n        })\n}\n\nfunction renderPieChart(relation_data) {\n    //Get values from the input\n    var year = d3.select(\"#year\").property(\"value\");\n    var city = d3.select(\"#city\").property(\"value\");\n\n    var legend_array = [];\n    var data = [];\n\n    var data_array = relation_data[city][year];\n    for (var i in data_array) {\n        var city_name = data_array[i];\n        legend_array.push(city_name);\n        data.push({\n            name: city_name,\n            value: 1\n        });\n    }\n    var pieChart = echarts.init(document.getElementById('pie'), null, {renderer: 'svg'});\n    var pieOption = {\n        title: {\n            text: city + ' in ' + year,\n            top: '3%',\n            left: '50%'\n        },\n        tooltip: {\n            trigger: 'item',\n            formatter: \"{b} : {c} ({d}%)\"\n        },\n        legend: {\n            orient: 'vertical',\n            top: '5%',\n            left: 'left',\n            data: legend_array\n        },\n        series: [{\n            type: 'pie',\n            radius: '60%',\n            center: ['65%', '60%'],\n            animation: false,\n            data: data,\n            itemStyle: {\n                emphasis: {\n                    shadowBlur: 10,\n                    shadowOffsetX: 0,\n                    shadowColor: 'rgba(0, 0, 0, 0.5)'\n                }\n            }\n        }]\n    };\n    pieChart.setOption(pieOption);\n}\n\nfunction renderLineChart(relation_data) {\n    var city = d3.select(\"#city\").property(\"value\");\n    var city_data = relation_data[city];\n\n    var data = [];\n    for (var i = 2000; i <= 2018; i++) {\n        data.push(city_data[i.toString()].length)\n    }\n\n    var lineChart = echarts.init(document.getElementById('line'), null, {renderer: 'svg'});\n    var lineOption = {\n        title: {\n            text: city + ' from 2000 to 2018',\n            top: '4%'\n        },\n        tooltip: {\n            trigger: 'axis'\n        },\n        grid: {\n            left: '3%',\n            right: '4%',\n            bottom: '3%',\n            containLabel: true\n        },\n        xAxis: {\n            type: 'category',\n            boundaryGap: false,\n            axisLabel: {\n                margin: 15\n            },\n            data: [2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018]\n        },\n        yAxis: {\n            type: 'value'\n        },\n        series: [{\n            type: 'line',\n            data: data\n        }]\n    };\n    lineChart.setOption(lineOption);\n}\n\n\n//Asynchronously load the data files\nd3.json(\"./city_location.json\", function (city_location) {\n    d3.json(\"./data.json\", function (data) {\n        location_data = city_location;\n        relation_data = data;\n\n        //Append cities into the city selection list\n        var city_selector = d3.select('#city');\n        for (var city in location_data) {\n            city_selector.append('option').text(city);\n        }\n        d3.select('#city').property('value', 'Los Angeles');\n        renderMap(projection);//Render the map after loading the data\n        drawCity(location_data, projection);//Draw cities after loading the data\n        drawLine(relation_data, location_data, projection, 0);\n        renderPieChart(relation_data);\n        renderLineChart(relation_data);\n    });\n});\n\n//Handle zoom (including drag) event\nd3.select('#map').call(\n    d3.behavior.zoom()\n        .scaleExtent([0.5, 5])\n        .on('zoom', function () {\n            //Update projection (projection will be changed after zooming or dragging)\n            projection = d3.geo.equirectangular()\n                .center([-98, 38])\n                .scale(projection_scale * d3.event.scale)\n                .translate([width / 2 + d3.event.translate[0], height / 2 + d3.event.translate[1]]);\n\n            renderMap(projection);\n            drawCity(location_data, projection);\n            drawLine(relation_data, location_data, projection, 0);\n        })\n);\n\n//Handle city selector change\nd3.select(\"#city\").on('change', function () {\n    drawLine(relation_data, location_data, projection, 300);\n    renderPieChart(relation_data);\n    renderLineChart(relation_data);\n});\n\n//Handle year input change\nd3.select(\"#year\").on('input', function () {\n    renderMap(projection);\n    drawCity(location_data, projection);\n    drawLine(relation_data, location_data, projection, 0);\n    renderPieChart(relation_data);\n});\n```\n***\n##### CSS\n```css\n.popup {\n    position: absolute;\n    text-align: center;\n    width: 80px;\n    height: 15px;\n    padding: 2px;\n    font: 12px sans-serif;\n    background: #ebebeb;\n    border: 0;\n    border-radius: 8px;\n    pointer-events: none;\n}\n\n#map {\n    width: 800px;\n    height: 250px;\n    position: relative;\n    margin: auto;\n}\n\n#input {\n    width: 800px;\n    position: relative;\n    margin: auto;\n}\n\nlabel {\n    color: #37ca98;\n    font-size: 20px;\n    font-weight: bold;\n}\n\ntable {\n    width: 100%;\n}\n\nth {\n    color: #e66d18;\n    font-size: 20px;\n    text-align: left;\n}\n\ntr {\n    color: #0026bf;\n    font-size: 12px;\n    font-weight: bold;\n    text-align: center;\n}\n\n#year {\n    -webkit-appearance: none;\n    width: 98%;\n    height: 15px;\n    border-radius: 5px;\n    background: #99ccff;\n    outline: none;\n    opacity: 0.7;\n    -webkit-transition: .2s;\n    transition: opacity .2s;\n}\n\n#year::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-thumb {\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-track {\n    background: none;\n}\n\nul {\n    color: #00242b;\n    font-weight: bold;\n}\n\n#pie {\n    width: 700px;\n    height: 300px;\n    margin: auto;\n\n}\n\n#line {\n    width: 700px;\n    height: 300px;\n    margin: auto;\n}\n```\n","source":"_posts/InteractiveMap_03.md","raw":"---\ntitle: Make an Interactive Map 03 - \"Let's make beautiful charts!\"\ndate: 2018-02-5 02:52:54\ncategories:\n- Data Visualization\ntags:\n- JavaScript\n- D3\n---\n#### Introduction\nThis visualization extends from my last blog [Make an Interactive Map 02 - \"Let's draw colorful lines!\"](https://brucehenry.github.io/blog/public/2018/01/31/InteractiveMap_02/). Most of the code remains the same.\n\nI add some charts which are able to show some detailed data beyond the map.\nTo generate the charts, I used [echarts](https://ecomfe.github.io/echarts-doc/public/en/index.html) which is an excellent data visualization tool from Baidu.\n\nAnyway, what I want to say is that you can add some other elements into the data visualization page combined with the map instead of adding too much elements into the map.\n\nLet's first see how it looks,\n<iframe width=\"820\" height=\"1060\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/03/map_with_chart.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n#### About Echarts\nInstead of making charts use D3, I choose to use echarts.\n\nBecause the colors and styles are already well designed, I can focus more on something else.\n\nAnd furthermore, it is totally free.\n\n#### Code\n\nYou can find the code at this [Github repository](https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/03).\n\n##### HTML\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width\">\n    <title>Advanced Interactive Map</title>\n    <link rel=\"stylesheet\" href=\"./map_with_chart.css\"/>\n\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"></script>\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"></script>\n</head>\n<body>\n\n<div id=\"map\"></div>\n\n<div id=\"input\">\n    <label for=\"city\">City</label>\n    <select id=\"city\" autocomplete=\"off\"></select>\n\n    <table>\n        <tr>\n            <th rowspan=\"2\">Year</th>\n            <td colspan=\"21\">\n                <label for=\"year\"></label>\n                <input type=\"range\" min=\"2000\" max=\"2018\" step=\"1\" value=\"2000\" autocomplete=\"off\" id=\"year\"/>\n            </td>\n        </tr>\n        <tr>\n            <td>2000</td>\n            <td>2001</td>\n            <td>2002</td>\n            <td>2003</td>\n            <td>2004</td>\n            <td>2005</td>\n            <td>2006</td>\n            <td>2007</td>\n            <td>2008</td>\n            <td>2009</td>\n            <td>2010</td>\n            <td>2011</td>\n            <td>2012</td>\n            <td>2013</td>\n            <td>2014</td>\n            <td>2015</td>\n            <td>2016</td>\n            <td>2017</td>\n            <td>2018</td>\n        </tr>\n    </table>\n    <ul>\n        <li>Try selecting a city (click on the map or use dropdown list).</li>\n        <li>Try dragging the year slider.</li>\n        <li>Try zooming in and dragging the map.</li>\n    </ul>\n</div>\n\n<div id=\"pie\"></div>\n<div id=\"line\"></div>\n\n<script src=\"./echarts.min.js\"></script>\n<script src=\"./map_with_chart.js\"></script>\n</body>\n</html>\n```\n***\n##### JavaScript\n```javascript\nvar relation_data;//relation data among cities\nvar location_data;//location data of cities\n\n//Get width and height of the outer <div> to set projection\nvar map_div = d3.select('#map').node().getBoundingClientRect();\nvar width = map_div.width, height = map_div.height;\n\n//This values means the initial scale of map, also how much you want the map to zoom in: d3.geo.scale = projection_scale * mouse_event_zoom\nvar projection_scale = 500;\n\n//Projection is a property to set the center and scale of map. Also, we can use it to get position in the map from real world geo coordinates.\nvar projection = d3.geo.equirectangular()\n    .center([-98, 38])//[longitude, latitude]\n    .scale(projection_scale)//Initial scale\n    .translate([width / 2, height / 2]);\n\n//Pop up a box when mouse is over a city\nvar popup = d3.select('body')\n    .append('div')\n    .attr('class', 'popup')\n    .style('opacity', 0);//Invisible\n\n\nfunction renderMap(projection) {\n    //Remove the previous map elements\n    const mapNode = document.getElementById(\"map\");\n    while (mapNode.firstChild) {\n        mapNode.removeChild(mapNode.firstChild);\n    }\n\n    //Render new map\n    new Datamaps({\n        element: document.getElementById('map'),\n        projection: 'mercator',\n        setProjection: function (element) {\n            const path = d3.geo.path().projection(projection);\n            return {path: path, projection: projection};\n        },\n        fills: {\n            defaultFill: '#8ebdee'\n        },\n        geographyConfig: {\n            popupOnHover: false, //disable the popup while hovering\n            highlightOnHover: false\n        }\n    });\n}\n\n//Function to draw circles(cities) on the map.\nfunction drawCity(location_data, projection) {\n    //Remove previous circles\n    d3.select('#circles').remove();\n\n    //Put the data into an array. The parameter of d3.(Select_Function).data() must be iterable.\n    var data = [];\n    for (var city in location_data) {\n        data.push({\n            city: city,\n            location: location_data[city]\n        });\n    }\n\n    //Append all circles into a <g> tag in order to manipulate them easily.\n    var circles = d3.select('svg')\n        .append('g')\n        .attr('id', 'circles')\n        .selectAll('circle');\n\n    //Set attributes and styles of circles based on the data\n    circles.data(data)\n        .enter()\n        .append('circle')\n        .attr('fill', '#ff919f')\n        .attr('r', 4)\n        .attr('cx', function (d) {\n            return projection(d.location)[0];\n        })\n        .attr('cy', function (d) {\n            return projection(d.location)[1];\n        })\n        .on('click', function (d) {\n            if (d3.select(\"#city\").property(\"value\") === d.city)\n                return;\n            d3.select('#city').property('value', d.city);\n            drawLine(relation_data, location_data, projection, 300);\n            renderPieChart(relation_data);\n            renderLineChart(relation_data);\n        })\n        .on('mouseover', function (d) {\n            d3.select(this).attr('r', 7).style('cursor', \"pointer\");\n            popup.style('opacity', .8)\n                .style('left', (d3.event.pageX) + 'px')\n                .style('top', (d3.event.pageY - 20) + 'px')\n                .text(d.city);\n        })\n        .on('mouseout', function () {\n            d3.select(this).attr('r', 4);\n            popup.transition()\n                .style('opacity', 0);\n        });\n}\n\n//Function to draw lines(relations) on the map.\nfunction drawLine(relation_data, location_data, projection, animation_length) {\n    //Remove previous circles\n    d3.select(\"#lines\").remove();\n\n    //Get values from the input\n    var year = d3.select(\"#year\").property(\"value\");\n    var city = d3.select(\"#city\").property(\"value\");\n\n    var data = relation_data[city][year];\n\n    var colorScale = d3.scale.category20();\n\n    //Append all lines into a <g> tag in order to manipulate them easily.\n    var lines = d3.select('svg')\n        .append('g')\n        .attr('id', 'lines')\n        .selectAll('line');\n\n    //Set attributes and styles of lines based on the data\n    lines.data(data)\n        .enter()\n        .append('line')\n        .attr('x1', projection(location_data[city])[0])\n        .attr('y1', projection(location_data[city])[1])\n        .attr('x2', projection(location_data[city])[0])\n        .attr('y2', projection(location_data[city])[1])\n        .style('stroke-width', '3px')\n        .style('stroke', function () {\n            return colorScale(Math.random());\n        })\n        .style('stroke-linecap', 'round')\n        .transition()\n        .duration(animation_length)\n        .attr('x2', function (d) {\n            return projection(location_data[d])[0];\n        })\n        .attr('y2', function (d) {\n            return projection(location_data[d])[1];\n        })\n}\n\nfunction renderPieChart(relation_data) {\n    //Get values from the input\n    var year = d3.select(\"#year\").property(\"value\");\n    var city = d3.select(\"#city\").property(\"value\");\n\n    var legend_array = [];\n    var data = [];\n\n    var data_array = relation_data[city][year];\n    for (var i in data_array) {\n        var city_name = data_array[i];\n        legend_array.push(city_name);\n        data.push({\n            name: city_name,\n            value: 1\n        });\n    }\n    var pieChart = echarts.init(document.getElementById('pie'), null, {renderer: 'svg'});\n    var pieOption = {\n        title: {\n            text: city + ' in ' + year,\n            top: '3%',\n            left: '50%'\n        },\n        tooltip: {\n            trigger: 'item',\n            formatter: \"{b} : {c} ({d}%)\"\n        },\n        legend: {\n            orient: 'vertical',\n            top: '5%',\n            left: 'left',\n            data: legend_array\n        },\n        series: [{\n            type: 'pie',\n            radius: '60%',\n            center: ['65%', '60%'],\n            animation: false,\n            data: data,\n            itemStyle: {\n                emphasis: {\n                    shadowBlur: 10,\n                    shadowOffsetX: 0,\n                    shadowColor: 'rgba(0, 0, 0, 0.5)'\n                }\n            }\n        }]\n    };\n    pieChart.setOption(pieOption);\n}\n\nfunction renderLineChart(relation_data) {\n    var city = d3.select(\"#city\").property(\"value\");\n    var city_data = relation_data[city];\n\n    var data = [];\n    for (var i = 2000; i <= 2018; i++) {\n        data.push(city_data[i.toString()].length)\n    }\n\n    var lineChart = echarts.init(document.getElementById('line'), null, {renderer: 'svg'});\n    var lineOption = {\n        title: {\n            text: city + ' from 2000 to 2018',\n            top: '4%'\n        },\n        tooltip: {\n            trigger: 'axis'\n        },\n        grid: {\n            left: '3%',\n            right: '4%',\n            bottom: '3%',\n            containLabel: true\n        },\n        xAxis: {\n            type: 'category',\n            boundaryGap: false,\n            axisLabel: {\n                margin: 15\n            },\n            data: [2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018]\n        },\n        yAxis: {\n            type: 'value'\n        },\n        series: [{\n            type: 'line',\n            data: data\n        }]\n    };\n    lineChart.setOption(lineOption);\n}\n\n\n//Asynchronously load the data files\nd3.json(\"./city_location.json\", function (city_location) {\n    d3.json(\"./data.json\", function (data) {\n        location_data = city_location;\n        relation_data = data;\n\n        //Append cities into the city selection list\n        var city_selector = d3.select('#city');\n        for (var city in location_data) {\n            city_selector.append('option').text(city);\n        }\n        d3.select('#city').property('value', 'Los Angeles');\n        renderMap(projection);//Render the map after loading the data\n        drawCity(location_data, projection);//Draw cities after loading the data\n        drawLine(relation_data, location_data, projection, 0);\n        renderPieChart(relation_data);\n        renderLineChart(relation_data);\n    });\n});\n\n//Handle zoom (including drag) event\nd3.select('#map').call(\n    d3.behavior.zoom()\n        .scaleExtent([0.5, 5])\n        .on('zoom', function () {\n            //Update projection (projection will be changed after zooming or dragging)\n            projection = d3.geo.equirectangular()\n                .center([-98, 38])\n                .scale(projection_scale * d3.event.scale)\n                .translate([width / 2 + d3.event.translate[0], height / 2 + d3.event.translate[1]]);\n\n            renderMap(projection);\n            drawCity(location_data, projection);\n            drawLine(relation_data, location_data, projection, 0);\n        })\n);\n\n//Handle city selector change\nd3.select(\"#city\").on('change', function () {\n    drawLine(relation_data, location_data, projection, 300);\n    renderPieChart(relation_data);\n    renderLineChart(relation_data);\n});\n\n//Handle year input change\nd3.select(\"#year\").on('input', function () {\n    renderMap(projection);\n    drawCity(location_data, projection);\n    drawLine(relation_data, location_data, projection, 0);\n    renderPieChart(relation_data);\n});\n```\n***\n##### CSS\n```css\n.popup {\n    position: absolute;\n    text-align: center;\n    width: 80px;\n    height: 15px;\n    padding: 2px;\n    font: 12px sans-serif;\n    background: #ebebeb;\n    border: 0;\n    border-radius: 8px;\n    pointer-events: none;\n}\n\n#map {\n    width: 800px;\n    height: 250px;\n    position: relative;\n    margin: auto;\n}\n\n#input {\n    width: 800px;\n    position: relative;\n    margin: auto;\n}\n\nlabel {\n    color: #37ca98;\n    font-size: 20px;\n    font-weight: bold;\n}\n\ntable {\n    width: 100%;\n}\n\nth {\n    color: #e66d18;\n    font-size: 20px;\n    text-align: left;\n}\n\ntr {\n    color: #0026bf;\n    font-size: 12px;\n    font-weight: bold;\n    text-align: center;\n}\n\n#year {\n    -webkit-appearance: none;\n    width: 98%;\n    height: 15px;\n    border-radius: 5px;\n    background: #99ccff;\n    outline: none;\n    opacity: 0.7;\n    -webkit-transition: .2s;\n    transition: opacity .2s;\n}\n\n#year::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-thumb {\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    background: #0462ff;\n    cursor: pointer;\n}\n\n#year::-moz-range-track {\n    background: none;\n}\n\nul {\n    color: #00242b;\n    font-weight: bold;\n}\n\n#pie {\n    width: 700px;\n    height: 300px;\n    margin: auto;\n\n}\n\n#line {\n    width: 700px;\n    height: 300px;\n    margin: auto;\n}\n```\n","slug":"InteractiveMap_03","published":1,"updated":"2018-02-15T04:58:21.403Z","_id":"cjdo197tp0000l8un6rbvsh4b","comments":1,"layout":"post","photos":[],"link":"","content":"<h4 id=\"Introduction\"><a href=\"#Introduction\" class=\"headerlink\" title=\"Introduction\"></a>Introduction</h4><p>This visualization extends from my last blog <a href=\"https://brucehenry.github.io/blog/public/2018/01/31/InteractiveMap_02/\">Make an Interactive Map 02 - “Let’s draw colorful lines!”</a>. Most of the code remains the same.</p>\n<p>I add some charts which are able to show some detailed data beyond the map.<br>To generate the charts, I used <a href=\"https://ecomfe.github.io/echarts-doc/public/en/index.html\" target=\"_blank\" rel=\"noopener\">echarts</a> which is an excellent data visualization tool from Baidu.</p>\n<p>Anyway, what I want to say is that you can add some other elements into the data visualization page combined with the map instead of adding too much elements into the map.</p>\n<p>Let’s first see how it looks,</p>\n<iframe width=\"820\" height=\"1060\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/03/map_with_chart.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n<h4 id=\"About-Echarts\"><a href=\"#About-Echarts\" class=\"headerlink\" title=\"About Echarts\"></a>About Echarts</h4><p>Instead of making charts use D3, I choose to use echarts.</p>\n<p>Because the colors and styles are already well designed, I can focus more on something else.</p>\n<p>And furthermore, it is totally free.</p>\n<h4 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h4><p>You can find the code at this <a href=\"https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/03\" target=\"_blank\" rel=\"noopener\">Github repository</a>.</p>\n<h5 id=\"HTML\"><a href=\"#HTML\" class=\"headerlink\" title=\"HTML\"></a>HTML</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Advanced Interactive Map<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"./map_with_chart.css\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"input\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"city\"</span>&gt;</span>City<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"city\"</span> <span class=\"attr\">autocomplete</span>=<span class=\"string\">\"off\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">th</span> <span class=\"attr\">rowspan</span>=<span class=\"string\">\"2\"</span>&gt;</span>Year<span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">colspan</span>=<span class=\"string\">\"21\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"year\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"range\"</span> <span class=\"attr\">min</span>=<span class=\"string\">\"2000\"</span> <span class=\"attr\">max</span>=<span class=\"string\">\"2018\"</span> <span class=\"attr\">step</span>=<span class=\"string\">\"1\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"2000\"</span> <span class=\"attr\">autocomplete</span>=<span class=\"string\">\"off\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"year\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2000<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2001<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2002<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2003<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2004<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2005<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2006<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2007<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2008<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2009<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2010<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2011<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2012<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2013<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2014<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2015<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2016<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2017<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2018<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try selecting a city (click on the map or use dropdown list).<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try dragging the year slider.<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try zooming in and dragging the map.<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"pie\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"line\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./echarts.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./map_with_chart.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"JavaScript\"><a href=\"#JavaScript\" class=\"headerlink\" title=\"JavaScript\"></a>JavaScript</h5><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> relation_data;<span class=\"comment\">//relation data among cities</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> location_data;<span class=\"comment\">//location data of cities</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Get width and height of the outer &lt;div&gt; to set projection</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> map_div = d3.select(<span class=\"string\">'#map'</span>).node().getBoundingClientRect();</span><br><span class=\"line\"><span class=\"keyword\">var</span> width = map_div.width, height = map_div.height;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//This values means the initial scale of map, also how much you want the map to zoom in: d3.geo.scale = projection_scale * mouse_event_zoom</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> projection_scale = <span class=\"number\">500</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Projection is a property to set the center and scale of map. Also, we can use it to get position in the map from real world geo coordinates.</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> projection = d3.geo.equirectangular()</span><br><span class=\"line\">    .center([<span class=\"number\">-98</span>, <span class=\"number\">38</span>])<span class=\"comment\">//[longitude, latitude]</span></span><br><span class=\"line\">    .scale(projection_scale)<span class=\"comment\">//Initial scale</span></span><br><span class=\"line\">    .translate([width / <span class=\"number\">2</span>, height / <span class=\"number\">2</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Pop up a box when mouse is over a city</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> popup = d3.select(<span class=\"string\">'body'</span>)</span><br><span class=\"line\">    .append(<span class=\"string\">'div'</span>)</span><br><span class=\"line\">    .attr(<span class=\"string\">'class'</span>, <span class=\"string\">'popup'</span>)</span><br><span class=\"line\">    .style(<span class=\"string\">'opacity'</span>, <span class=\"number\">0</span>);<span class=\"comment\">//Invisible</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">renderMap</span>(<span class=\"params\">projection</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove the previous map elements</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> mapNode = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">\"map\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (mapNode.firstChild) &#123;</span><br><span class=\"line\">        mapNode.removeChild(mapNode.firstChild);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Render new map</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> Datamaps(&#123;</span><br><span class=\"line\">        element: <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'map'</span>),</span><br><span class=\"line\">        projection: <span class=\"string\">'mercator'</span>,</span><br><span class=\"line\">        setProjection: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> path = d3.geo.path().projection(projection);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"attr\">path</span>: path, <span class=\"attr\">projection</span>: projection&#125;;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        fills: &#123;</span><br><span class=\"line\">            defaultFill: <span class=\"string\">'#8ebdee'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        geographyConfig: &#123;</span><br><span class=\"line\">            popupOnHover: <span class=\"literal\">false</span>, <span class=\"comment\">//disable the popup while hovering</span></span><br><span class=\"line\">            highlightOnHover: <span class=\"literal\">false</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Function to draw circles(cities) on the map.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">drawCity</span>(<span class=\"params\">location_data, projection</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove previous circles</span></span><br><span class=\"line\">    d3.select(<span class=\"string\">'#circles'</span>).remove();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Put the data into an array. The parameter of d3.(Select_Function).data() must be iterable.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = [];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> city <span class=\"keyword\">in</span> location_data) &#123;</span><br><span class=\"line\">        data.push(&#123;</span><br><span class=\"line\">            city: city,</span><br><span class=\"line\">            location: location_data[city]</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Append all circles into a &lt;g&gt; tag in order to manipulate them easily.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> circles = d3.select(<span class=\"string\">'svg'</span>)</span><br><span class=\"line\">        .append(<span class=\"string\">'g'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'id'</span>, <span class=\"string\">'circles'</span>)</span><br><span class=\"line\">        .selectAll(<span class=\"string\">'circle'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Set attributes and styles of circles based on the data</span></span><br><span class=\"line\">    circles.data(data)</span><br><span class=\"line\">        .enter()</span><br><span class=\"line\">        .append(<span class=\"string\">'circle'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'fill'</span>, <span class=\"string\">'#ff919f'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'r'</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'cx'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(d.location)[<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .attr(<span class=\"string\">'cy'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(d.location)[<span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'click'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>) === d.city)</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            d3.select(<span class=\"string\">'#city'</span>).property(<span class=\"string\">'value'</span>, d.city);</span><br><span class=\"line\">            drawLine(relation_data, location_data, projection, <span class=\"number\">300</span>);</span><br><span class=\"line\">            renderPieChart(relation_data);</span><br><span class=\"line\">            renderLineChart(relation_data);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'mouseover'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            d3.select(<span class=\"keyword\">this</span>).attr(<span class=\"string\">'r'</span>, <span class=\"number\">7</span>).style(<span class=\"string\">'cursor'</span>, <span class=\"string\">\"pointer\"</span>);</span><br><span class=\"line\">            popup.style(<span class=\"string\">'opacity'</span>, <span class=\"number\">.8</span>)</span><br><span class=\"line\">                .style(<span class=\"string\">'left'</span>, (d3.event.pageX) + <span class=\"string\">'px'</span>)</span><br><span class=\"line\">                .style(<span class=\"string\">'top'</span>, (d3.event.pageY - <span class=\"number\">20</span>) + <span class=\"string\">'px'</span>)</span><br><span class=\"line\">                .text(d.city);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'mouseout'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            d3.select(<span class=\"keyword\">this</span>).attr(<span class=\"string\">'r'</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">            popup.transition()</span><br><span class=\"line\">                .style(<span class=\"string\">'opacity'</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Function to draw lines(relations) on the map.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">drawLine</span>(<span class=\"params\">relation_data, location_data, projection, animation_length</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove previous circles</span></span><br><span class=\"line\">    d3.select(<span class=\"string\">\"#lines\"</span>).remove();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Get values from the input</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = d3.select(<span class=\"string\">\"#year\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> city = d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = relation_data[city][year];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> colorScale = d3.scale.category20();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Append all lines into a &lt;g&gt; tag in order to manipulate them easily.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> lines = d3.select(<span class=\"string\">'svg'</span>)</span><br><span class=\"line\">        .append(<span class=\"string\">'g'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'id'</span>, <span class=\"string\">'lines'</span>)</span><br><span class=\"line\">        .selectAll(<span class=\"string\">'line'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Set attributes and styles of lines based on the data</span></span><br><span class=\"line\">    lines.data(data)</span><br><span class=\"line\">        .enter()</span><br><span class=\"line\">        .append(<span class=\"string\">'line'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'x1'</span>, projection(location_data[city])[<span class=\"number\">0</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'y1'</span>, projection(location_data[city])[<span class=\"number\">1</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'x2'</span>, projection(location_data[city])[<span class=\"number\">0</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'y2'</span>, projection(location_data[city])[<span class=\"number\">1</span>])</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke-width'</span>, <span class=\"string\">'3px'</span>)</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> colorScale(<span class=\"built_in\">Math</span>.random());</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke-linecap'</span>, <span class=\"string\">'round'</span>)</span><br><span class=\"line\">        .transition()</span><br><span class=\"line\">        .duration(animation_length)</span><br><span class=\"line\">        .attr(<span class=\"string\">'x2'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(location_data[d])[<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .attr(<span class=\"string\">'y2'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(location_data[d])[<span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">renderPieChart</span>(<span class=\"params\">relation_data</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Get values from the input</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = d3.select(<span class=\"string\">\"#year\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> city = d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> legend_array = [];</span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data_array = relation_data[city][year];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i <span class=\"keyword\">in</span> data_array) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> city_name = data_array[i];</span><br><span class=\"line\">        legend_array.push(city_name);</span><br><span class=\"line\">        data.push(&#123;</span><br><span class=\"line\">            name: city_name,</span><br><span class=\"line\">            value: <span class=\"number\">1</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> pieChart = echarts.init(<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'pie'</span>), <span class=\"literal\">null</span>, &#123;<span class=\"attr\">renderer</span>: <span class=\"string\">'svg'</span>&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> pieOption = &#123;</span><br><span class=\"line\">        title: &#123;</span><br><span class=\"line\">            text: city + <span class=\"string\">' in '</span> + year,</span><br><span class=\"line\">            top: <span class=\"string\">'3%'</span>,</span><br><span class=\"line\">            left: <span class=\"string\">'50%'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        tooltip: &#123;</span><br><span class=\"line\">            trigger: <span class=\"string\">'item'</span>,</span><br><span class=\"line\">            formatter: <span class=\"string\">\"&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)\"</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        legend: &#123;</span><br><span class=\"line\">            orient: <span class=\"string\">'vertical'</span>,</span><br><span class=\"line\">            top: <span class=\"string\">'5%'</span>,</span><br><span class=\"line\">            left: <span class=\"string\">'left'</span>,</span><br><span class=\"line\">            data: legend_array</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        series: [&#123;</span><br><span class=\"line\">            type: <span class=\"string\">'pie'</span>,</span><br><span class=\"line\">            radius: <span class=\"string\">'60%'</span>,</span><br><span class=\"line\">            center: [<span class=\"string\">'65%'</span>, <span class=\"string\">'60%'</span>],</span><br><span class=\"line\">            animation: <span class=\"literal\">false</span>,</span><br><span class=\"line\">            data: data,</span><br><span class=\"line\">            itemStyle: &#123;</span><br><span class=\"line\">                emphasis: &#123;</span><br><span class=\"line\">                    shadowBlur: <span class=\"number\">10</span>,</span><br><span class=\"line\">                    shadowOffsetX: <span class=\"number\">0</span>,</span><br><span class=\"line\">                    shadowColor: <span class=\"string\">'rgba(0, 0, 0, 0.5)'</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;]</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    pieChart.setOption(pieOption);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">renderLineChart</span>(<span class=\"params\">relation_data</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> city = d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> city_data = relation_data[city];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = [];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">2000</span>; i &lt;= <span class=\"number\">2018</span>; i++) &#123;</span><br><span class=\"line\">        data.push(city_data[i.toString()].length)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> lineChart = echarts.init(<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'line'</span>), <span class=\"literal\">null</span>, &#123;<span class=\"attr\">renderer</span>: <span class=\"string\">'svg'</span>&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> lineOption = &#123;</span><br><span class=\"line\">        title: &#123;</span><br><span class=\"line\">            text: city + <span class=\"string\">' from 2000 to 2018'</span>,</span><br><span class=\"line\">            top: <span class=\"string\">'4%'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        tooltip: &#123;</span><br><span class=\"line\">            trigger: <span class=\"string\">'axis'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        grid: &#123;</span><br><span class=\"line\">            left: <span class=\"string\">'3%'</span>,</span><br><span class=\"line\">            right: <span class=\"string\">'4%'</span>,</span><br><span class=\"line\">            bottom: <span class=\"string\">'3%'</span>,</span><br><span class=\"line\">            containLabel: <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        xAxis: &#123;</span><br><span class=\"line\">            type: <span class=\"string\">'category'</span>,</span><br><span class=\"line\">            boundaryGap: <span class=\"literal\">false</span>,</span><br><span class=\"line\">            axisLabel: &#123;</span><br><span class=\"line\">                margin: <span class=\"number\">15</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            data: [<span class=\"number\">2000</span>, <span class=\"number\">2001</span>, <span class=\"number\">2002</span>, <span class=\"number\">2003</span>, <span class=\"number\">2004</span>, <span class=\"number\">2005</span>, <span class=\"number\">2006</span>, <span class=\"number\">2007</span>, <span class=\"number\">2008</span>, <span class=\"number\">2009</span>, <span class=\"number\">2010</span>, <span class=\"number\">2011</span>, <span class=\"number\">2012</span>, <span class=\"number\">2013</span>, <span class=\"number\">2014</span>, <span class=\"number\">2015</span>, <span class=\"number\">2016</span>, <span class=\"number\">2017</span>, <span class=\"number\">2018</span>]</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        yAxis: &#123;</span><br><span class=\"line\">            type: <span class=\"string\">'value'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        series: [&#123;</span><br><span class=\"line\">            type: <span class=\"string\">'line'</span>,</span><br><span class=\"line\">            data: data</span><br><span class=\"line\">        &#125;]</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    lineChart.setOption(lineOption);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Asynchronously load the data files</span></span><br><span class=\"line\">d3.json(<span class=\"string\">\"./city_location.json\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">city_location</span>) </span>&#123;</span><br><span class=\"line\">    d3.json(<span class=\"string\">\"./data.json\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">        location_data = city_location;</span><br><span class=\"line\">        relation_data = data;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//Append cities into the city selection list</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> city_selector = d3.select(<span class=\"string\">'#city'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> city <span class=\"keyword\">in</span> location_data) &#123;</span><br><span class=\"line\">            city_selector.append(<span class=\"string\">'option'</span>).text(city);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        d3.select(<span class=\"string\">'#city'</span>).property(<span class=\"string\">'value'</span>, <span class=\"string\">'Los Angeles'</span>);</span><br><span class=\"line\">        renderMap(projection);<span class=\"comment\">//Render the map after loading the data</span></span><br><span class=\"line\">        drawCity(location_data, projection);<span class=\"comment\">//Draw cities after loading the data</span></span><br><span class=\"line\">        drawLine(relation_data, location_data, projection, <span class=\"number\">0</span>);</span><br><span class=\"line\">        renderPieChart(relation_data);</span><br><span class=\"line\">        renderLineChart(relation_data);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle zoom (including drag) event</span></span><br><span class=\"line\">d3.select(<span class=\"string\">'#map'</span>).call(</span><br><span class=\"line\">    d3.behavior.zoom()</span><br><span class=\"line\">        .scaleExtent([<span class=\"number\">0.5</span>, <span class=\"number\">5</span>])</span><br><span class=\"line\">        .on(<span class=\"string\">'zoom'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">//Update projection (projection will be changed after zooming or dragging)</span></span><br><span class=\"line\">            projection = d3.geo.equirectangular()</span><br><span class=\"line\">                .center([<span class=\"number\">-98</span>, <span class=\"number\">38</span>])</span><br><span class=\"line\">                .scale(projection_scale * d3.event.scale)</span><br><span class=\"line\">                .translate([width / <span class=\"number\">2</span> + d3.event.translate[<span class=\"number\">0</span>], height / <span class=\"number\">2</span> + d3.event.translate[<span class=\"number\">1</span>]]);</span><br><span class=\"line\"></span><br><span class=\"line\">            renderMap(projection);</span><br><span class=\"line\">            drawCity(location_data, projection);</span><br><span class=\"line\">            drawLine(relation_data, location_data, projection, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle city selector change</span></span><br><span class=\"line\">d3.select(<span class=\"string\">\"#city\"</span>).on(<span class=\"string\">'change'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    drawLine(relation_data, location_data, projection, <span class=\"number\">300</span>);</span><br><span class=\"line\">    renderPieChart(relation_data);</span><br><span class=\"line\">    renderLineChart(relation_data);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle year input change</span></span><br><span class=\"line\">d3.select(<span class=\"string\">\"#year\"</span>).on(<span class=\"string\">'input'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    renderMap(projection);</span><br><span class=\"line\">    drawCity(location_data, projection);</span><br><span class=\"line\">    drawLine(relation_data, location_data, projection, <span class=\"number\">0</span>);</span><br><span class=\"line\">    renderPieChart(relation_data);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"CSS\"><a href=\"#CSS\" class=\"headerlink\" title=\"CSS\"></a>CSS</h5><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.popup</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">2px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font</span>: <span class=\"number\">12px</span> sans-serif;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#ebebeb</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">8px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">pointer-events</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#map</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">250px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#input</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">label</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#37ca98</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">table</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">th</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#e66d18</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: left;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">tr</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#0026bf</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">12px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">98%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#99ccff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">outline</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: <span class=\"number\">0.7</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-transition</span>: .<span class=\"number\">2s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: opacity .<span class=\"number\">2s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-webkit-slider-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-track</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">ul</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#00242b</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#pie</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">700px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#line</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">700px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"Introduction\"><a href=\"#Introduction\" class=\"headerlink\" title=\"Introduction\"></a>Introduction</h4><p>This visualization extends from my last blog <a href=\"https://brucehenry.github.io/blog/public/2018/01/31/InteractiveMap_02/\">Make an Interactive Map 02 - “Let’s draw colorful lines!”</a>. Most of the code remains the same.</p>\n<p>I add some charts which are able to show some detailed data beyond the map.<br>To generate the charts, I used <a href=\"https://ecomfe.github.io/echarts-doc/public/en/index.html\" target=\"_blank\" rel=\"noopener\">echarts</a> which is an excellent data visualization tool from Baidu.</p>\n<p>Anyway, what I want to say is that you can add some other elements into the data visualization page combined with the map instead of adding too much elements into the map.</p>\n<p>Let’s first see how it looks,</p>\n<iframe width=\"820\" height=\"1060\" src=\"https://brucehenry.github.io/blog-webpage/interactive-map/03/map_with_chart.html\">You browser does not support iframe tag, <a href=\"https://brucehenry.github.io/blog-webpage/interactive-map/02/advanced_map.html\" target=\"_blank\">click here to visit</a>.</iframe>\n\n<h4 id=\"About-Echarts\"><a href=\"#About-Echarts\" class=\"headerlink\" title=\"About Echarts\"></a>About Echarts</h4><p>Instead of making charts use D3, I choose to use echarts.</p>\n<p>Because the colors and styles are already well designed, I can focus more on something else.</p>\n<p>And furthermore, it is totally free.</p>\n<h4 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h4><p>You can find the code at this <a href=\"https://github.com/BruceHenry/blog-webpage/tree/master/interactive-map/03\" target=\"_blank\" rel=\"noopener\">Github repository</a>.</p>\n<h5 id=\"HTML\"><a href=\"#HTML\" class=\"headerlink\" title=\"HTML\"></a>HTML</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Advanced Interactive Map<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"./map_with_chart.css\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.8/datamaps.all.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"input\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"city\"</span>&gt;</span>City<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"city\"</span> <span class=\"attr\">autocomplete</span>=<span class=\"string\">\"off\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">th</span> <span class=\"attr\">rowspan</span>=<span class=\"string\">\"2\"</span>&gt;</span>Year<span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">colspan</span>=<span class=\"string\">\"21\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"year\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"range\"</span> <span class=\"attr\">min</span>=<span class=\"string\">\"2000\"</span> <span class=\"attr\">max</span>=<span class=\"string\">\"2018\"</span> <span class=\"attr\">step</span>=<span class=\"string\">\"1\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"2000\"</span> <span class=\"attr\">autocomplete</span>=<span class=\"string\">\"off\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"year\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2000<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2001<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2002<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2003<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2004<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2005<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2006<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2007<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2008<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2009<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2010<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2011<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2012<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2013<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2014<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2015<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2016<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2017<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2018<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try selecting a city (click on the map or use dropdown list).<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try dragging the year slider.<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>Try zooming in and dragging the map.<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"pie\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"line\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./echarts.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./map_with_chart.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"JavaScript\"><a href=\"#JavaScript\" class=\"headerlink\" title=\"JavaScript\"></a>JavaScript</h5><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> relation_data;<span class=\"comment\">//relation data among cities</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> location_data;<span class=\"comment\">//location data of cities</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Get width and height of the outer &lt;div&gt; to set projection</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> map_div = d3.select(<span class=\"string\">'#map'</span>).node().getBoundingClientRect();</span><br><span class=\"line\"><span class=\"keyword\">var</span> width = map_div.width, height = map_div.height;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//This values means the initial scale of map, also how much you want the map to zoom in: d3.geo.scale = projection_scale * mouse_event_zoom</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> projection_scale = <span class=\"number\">500</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Projection is a property to set the center and scale of map. Also, we can use it to get position in the map from real world geo coordinates.</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> projection = d3.geo.equirectangular()</span><br><span class=\"line\">    .center([<span class=\"number\">-98</span>, <span class=\"number\">38</span>])<span class=\"comment\">//[longitude, latitude]</span></span><br><span class=\"line\">    .scale(projection_scale)<span class=\"comment\">//Initial scale</span></span><br><span class=\"line\">    .translate([width / <span class=\"number\">2</span>, height / <span class=\"number\">2</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Pop up a box when mouse is over a city</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> popup = d3.select(<span class=\"string\">'body'</span>)</span><br><span class=\"line\">    .append(<span class=\"string\">'div'</span>)</span><br><span class=\"line\">    .attr(<span class=\"string\">'class'</span>, <span class=\"string\">'popup'</span>)</span><br><span class=\"line\">    .style(<span class=\"string\">'opacity'</span>, <span class=\"number\">0</span>);<span class=\"comment\">//Invisible</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">renderMap</span>(<span class=\"params\">projection</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove the previous map elements</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> mapNode = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">\"map\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (mapNode.firstChild) &#123;</span><br><span class=\"line\">        mapNode.removeChild(mapNode.firstChild);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Render new map</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> Datamaps(&#123;</span><br><span class=\"line\">        element: <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'map'</span>),</span><br><span class=\"line\">        projection: <span class=\"string\">'mercator'</span>,</span><br><span class=\"line\">        setProjection: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> path = d3.geo.path().projection(projection);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;<span class=\"attr\">path</span>: path, <span class=\"attr\">projection</span>: projection&#125;;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        fills: &#123;</span><br><span class=\"line\">            defaultFill: <span class=\"string\">'#8ebdee'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        geographyConfig: &#123;</span><br><span class=\"line\">            popupOnHover: <span class=\"literal\">false</span>, <span class=\"comment\">//disable the popup while hovering</span></span><br><span class=\"line\">            highlightOnHover: <span class=\"literal\">false</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Function to draw circles(cities) on the map.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">drawCity</span>(<span class=\"params\">location_data, projection</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove previous circles</span></span><br><span class=\"line\">    d3.select(<span class=\"string\">'#circles'</span>).remove();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Put the data into an array. The parameter of d3.(Select_Function).data() must be iterable.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = [];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> city <span class=\"keyword\">in</span> location_data) &#123;</span><br><span class=\"line\">        data.push(&#123;</span><br><span class=\"line\">            city: city,</span><br><span class=\"line\">            location: location_data[city]</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Append all circles into a &lt;g&gt; tag in order to manipulate them easily.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> circles = d3.select(<span class=\"string\">'svg'</span>)</span><br><span class=\"line\">        .append(<span class=\"string\">'g'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'id'</span>, <span class=\"string\">'circles'</span>)</span><br><span class=\"line\">        .selectAll(<span class=\"string\">'circle'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Set attributes and styles of circles based on the data</span></span><br><span class=\"line\">    circles.data(data)</span><br><span class=\"line\">        .enter()</span><br><span class=\"line\">        .append(<span class=\"string\">'circle'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'fill'</span>, <span class=\"string\">'#ff919f'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'r'</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'cx'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(d.location)[<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .attr(<span class=\"string\">'cy'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(d.location)[<span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'click'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>) === d.city)</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            d3.select(<span class=\"string\">'#city'</span>).property(<span class=\"string\">'value'</span>, d.city);</span><br><span class=\"line\">            drawLine(relation_data, location_data, projection, <span class=\"number\">300</span>);</span><br><span class=\"line\">            renderPieChart(relation_data);</span><br><span class=\"line\">            renderLineChart(relation_data);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'mouseover'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            d3.select(<span class=\"keyword\">this</span>).attr(<span class=\"string\">'r'</span>, <span class=\"number\">7</span>).style(<span class=\"string\">'cursor'</span>, <span class=\"string\">\"pointer\"</span>);</span><br><span class=\"line\">            popup.style(<span class=\"string\">'opacity'</span>, <span class=\"number\">.8</span>)</span><br><span class=\"line\">                .style(<span class=\"string\">'left'</span>, (d3.event.pageX) + <span class=\"string\">'px'</span>)</span><br><span class=\"line\">                .style(<span class=\"string\">'top'</span>, (d3.event.pageY - <span class=\"number\">20</span>) + <span class=\"string\">'px'</span>)</span><br><span class=\"line\">                .text(d.city);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .on(<span class=\"string\">'mouseout'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            d3.select(<span class=\"keyword\">this</span>).attr(<span class=\"string\">'r'</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">            popup.transition()</span><br><span class=\"line\">                .style(<span class=\"string\">'opacity'</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Function to draw lines(relations) on the map.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">drawLine</span>(<span class=\"params\">relation_data, location_data, projection, animation_length</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Remove previous circles</span></span><br><span class=\"line\">    d3.select(<span class=\"string\">\"#lines\"</span>).remove();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Get values from the input</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = d3.select(<span class=\"string\">\"#year\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> city = d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = relation_data[city][year];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> colorScale = d3.scale.category20();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Append all lines into a &lt;g&gt; tag in order to manipulate them easily.</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> lines = d3.select(<span class=\"string\">'svg'</span>)</span><br><span class=\"line\">        .append(<span class=\"string\">'g'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'id'</span>, <span class=\"string\">'lines'</span>)</span><br><span class=\"line\">        .selectAll(<span class=\"string\">'line'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Set attributes and styles of lines based on the data</span></span><br><span class=\"line\">    lines.data(data)</span><br><span class=\"line\">        .enter()</span><br><span class=\"line\">        .append(<span class=\"string\">'line'</span>)</span><br><span class=\"line\">        .attr(<span class=\"string\">'x1'</span>, projection(location_data[city])[<span class=\"number\">0</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'y1'</span>, projection(location_data[city])[<span class=\"number\">1</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'x2'</span>, projection(location_data[city])[<span class=\"number\">0</span>])</span><br><span class=\"line\">        .attr(<span class=\"string\">'y2'</span>, projection(location_data[city])[<span class=\"number\">1</span>])</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke-width'</span>, <span class=\"string\">'3px'</span>)</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> colorScale(<span class=\"built_in\">Math</span>.random());</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .style(<span class=\"string\">'stroke-linecap'</span>, <span class=\"string\">'round'</span>)</span><br><span class=\"line\">        .transition()</span><br><span class=\"line\">        .duration(animation_length)</span><br><span class=\"line\">        .attr(<span class=\"string\">'x2'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(location_data[d])[<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .attr(<span class=\"string\">'y2'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">d</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> projection(location_data[d])[<span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">renderPieChart</span>(<span class=\"params\">relation_data</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//Get values from the input</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> year = d3.select(<span class=\"string\">\"#year\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> city = d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> legend_array = [];</span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data_array = relation_data[city][year];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i <span class=\"keyword\">in</span> data_array) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> city_name = data_array[i];</span><br><span class=\"line\">        legend_array.push(city_name);</span><br><span class=\"line\">        data.push(&#123;</span><br><span class=\"line\">            name: city_name,</span><br><span class=\"line\">            value: <span class=\"number\">1</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> pieChart = echarts.init(<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'pie'</span>), <span class=\"literal\">null</span>, &#123;<span class=\"attr\">renderer</span>: <span class=\"string\">'svg'</span>&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> pieOption = &#123;</span><br><span class=\"line\">        title: &#123;</span><br><span class=\"line\">            text: city + <span class=\"string\">' in '</span> + year,</span><br><span class=\"line\">            top: <span class=\"string\">'3%'</span>,</span><br><span class=\"line\">            left: <span class=\"string\">'50%'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        tooltip: &#123;</span><br><span class=\"line\">            trigger: <span class=\"string\">'item'</span>,</span><br><span class=\"line\">            formatter: <span class=\"string\">\"&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)\"</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        legend: &#123;</span><br><span class=\"line\">            orient: <span class=\"string\">'vertical'</span>,</span><br><span class=\"line\">            top: <span class=\"string\">'5%'</span>,</span><br><span class=\"line\">            left: <span class=\"string\">'left'</span>,</span><br><span class=\"line\">            data: legend_array</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        series: [&#123;</span><br><span class=\"line\">            type: <span class=\"string\">'pie'</span>,</span><br><span class=\"line\">            radius: <span class=\"string\">'60%'</span>,</span><br><span class=\"line\">            center: [<span class=\"string\">'65%'</span>, <span class=\"string\">'60%'</span>],</span><br><span class=\"line\">            animation: <span class=\"literal\">false</span>,</span><br><span class=\"line\">            data: data,</span><br><span class=\"line\">            itemStyle: &#123;</span><br><span class=\"line\">                emphasis: &#123;</span><br><span class=\"line\">                    shadowBlur: <span class=\"number\">10</span>,</span><br><span class=\"line\">                    shadowOffsetX: <span class=\"number\">0</span>,</span><br><span class=\"line\">                    shadowColor: <span class=\"string\">'rgba(0, 0, 0, 0.5)'</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;]</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    pieChart.setOption(pieOption);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">renderLineChart</span>(<span class=\"params\">relation_data</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> city = d3.select(<span class=\"string\">\"#city\"</span>).property(<span class=\"string\">\"value\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> city_data = relation_data[city];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> data = [];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">2000</span>; i &lt;= <span class=\"number\">2018</span>; i++) &#123;</span><br><span class=\"line\">        data.push(city_data[i.toString()].length)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> lineChart = echarts.init(<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'line'</span>), <span class=\"literal\">null</span>, &#123;<span class=\"attr\">renderer</span>: <span class=\"string\">'svg'</span>&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> lineOption = &#123;</span><br><span class=\"line\">        title: &#123;</span><br><span class=\"line\">            text: city + <span class=\"string\">' from 2000 to 2018'</span>,</span><br><span class=\"line\">            top: <span class=\"string\">'4%'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        tooltip: &#123;</span><br><span class=\"line\">            trigger: <span class=\"string\">'axis'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        grid: &#123;</span><br><span class=\"line\">            left: <span class=\"string\">'3%'</span>,</span><br><span class=\"line\">            right: <span class=\"string\">'4%'</span>,</span><br><span class=\"line\">            bottom: <span class=\"string\">'3%'</span>,</span><br><span class=\"line\">            containLabel: <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        xAxis: &#123;</span><br><span class=\"line\">            type: <span class=\"string\">'category'</span>,</span><br><span class=\"line\">            boundaryGap: <span class=\"literal\">false</span>,</span><br><span class=\"line\">            axisLabel: &#123;</span><br><span class=\"line\">                margin: <span class=\"number\">15</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            data: [<span class=\"number\">2000</span>, <span class=\"number\">2001</span>, <span class=\"number\">2002</span>, <span class=\"number\">2003</span>, <span class=\"number\">2004</span>, <span class=\"number\">2005</span>, <span class=\"number\">2006</span>, <span class=\"number\">2007</span>, <span class=\"number\">2008</span>, <span class=\"number\">2009</span>, <span class=\"number\">2010</span>, <span class=\"number\">2011</span>, <span class=\"number\">2012</span>, <span class=\"number\">2013</span>, <span class=\"number\">2014</span>, <span class=\"number\">2015</span>, <span class=\"number\">2016</span>, <span class=\"number\">2017</span>, <span class=\"number\">2018</span>]</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        yAxis: &#123;</span><br><span class=\"line\">            type: <span class=\"string\">'value'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        series: [&#123;</span><br><span class=\"line\">            type: <span class=\"string\">'line'</span>,</span><br><span class=\"line\">            data: data</span><br><span class=\"line\">        &#125;]</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    lineChart.setOption(lineOption);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Asynchronously load the data files</span></span><br><span class=\"line\">d3.json(<span class=\"string\">\"./city_location.json\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">city_location</span>) </span>&#123;</span><br><span class=\"line\">    d3.json(<span class=\"string\">\"./data.json\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span><br><span class=\"line\">        location_data = city_location;</span><br><span class=\"line\">        relation_data = data;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//Append cities into the city selection list</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> city_selector = d3.select(<span class=\"string\">'#city'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> city <span class=\"keyword\">in</span> location_data) &#123;</span><br><span class=\"line\">            city_selector.append(<span class=\"string\">'option'</span>).text(city);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        d3.select(<span class=\"string\">'#city'</span>).property(<span class=\"string\">'value'</span>, <span class=\"string\">'Los Angeles'</span>);</span><br><span class=\"line\">        renderMap(projection);<span class=\"comment\">//Render the map after loading the data</span></span><br><span class=\"line\">        drawCity(location_data, projection);<span class=\"comment\">//Draw cities after loading the data</span></span><br><span class=\"line\">        drawLine(relation_data, location_data, projection, <span class=\"number\">0</span>);</span><br><span class=\"line\">        renderPieChart(relation_data);</span><br><span class=\"line\">        renderLineChart(relation_data);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle zoom (including drag) event</span></span><br><span class=\"line\">d3.select(<span class=\"string\">'#map'</span>).call(</span><br><span class=\"line\">    d3.behavior.zoom()</span><br><span class=\"line\">        .scaleExtent([<span class=\"number\">0.5</span>, <span class=\"number\">5</span>])</span><br><span class=\"line\">        .on(<span class=\"string\">'zoom'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">//Update projection (projection will be changed after zooming or dragging)</span></span><br><span class=\"line\">            projection = d3.geo.equirectangular()</span><br><span class=\"line\">                .center([<span class=\"number\">-98</span>, <span class=\"number\">38</span>])</span><br><span class=\"line\">                .scale(projection_scale * d3.event.scale)</span><br><span class=\"line\">                .translate([width / <span class=\"number\">2</span> + d3.event.translate[<span class=\"number\">0</span>], height / <span class=\"number\">2</span> + d3.event.translate[<span class=\"number\">1</span>]]);</span><br><span class=\"line\"></span><br><span class=\"line\">            renderMap(projection);</span><br><span class=\"line\">            drawCity(location_data, projection);</span><br><span class=\"line\">            drawLine(relation_data, location_data, projection, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle city selector change</span></span><br><span class=\"line\">d3.select(<span class=\"string\">\"#city\"</span>).on(<span class=\"string\">'change'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    drawLine(relation_data, location_data, projection, <span class=\"number\">300</span>);</span><br><span class=\"line\">    renderPieChart(relation_data);</span><br><span class=\"line\">    renderLineChart(relation_data);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Handle year input change</span></span><br><span class=\"line\">d3.select(<span class=\"string\">\"#year\"</span>).on(<span class=\"string\">'input'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    renderMap(projection);</span><br><span class=\"line\">    drawCity(location_data, projection);</span><br><span class=\"line\">    drawLine(relation_data, location_data, projection, <span class=\"number\">0</span>);</span><br><span class=\"line\">    renderPieChart(relation_data);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<hr>\n<h5 id=\"CSS\"><a href=\"#CSS\" class=\"headerlink\" title=\"CSS\"></a>CSS</h5><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.popup</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">80px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">2px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font</span>: <span class=\"number\">12px</span> sans-serif;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#ebebeb</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">8px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">pointer-events</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#map</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">250px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#input</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">label</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#37ca98</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">table</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">th</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#e66d18</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: left;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">tr</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#0026bf</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">12px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">    <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">98%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#99ccff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">outline</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: <span class=\"number\">0.7</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-transition</span>: .<span class=\"number\">2s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: opacity .<span class=\"number\">2s</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-webkit-slider-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-appearance</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-thumb</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">50%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#0462ff</span>;</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#year</span><span class=\"selector-pseudo\">::-moz-range-track</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">ul</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#00242b</span>;</span><br><span class=\"line\">    <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#pie</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">700px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#line</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">700px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: auto;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cjd8gvpk00001l4und3mleixp","category_id":"cjd8gvpk40004l4unr5gx75gs","_id":"cjd8gvpk70008l4uno2ionl96"},{"post_id":"cjd8gvpjw0000l4unifjpnynz","category_id":"cjd9cof1j0000iwunffne030o","_id":"cjd9cof1l0001iwuncyjghqvi"},{"post_id":"cjd8gvpk30003l4unk6s2mlkw","category_id":"cjd9cof1j0000iwunffne030o","_id":"cjd9cof1r0002iwuni9c2d2ic"},{"post_id":"cjdmw73ep0000lsunohqe2x06","category_id":"cjd8gvpk40004l4unr5gx75gs","_id":"cjdmw73ev0003lsunsrdrla6r"},{"post_id":"cjdo197tp0000l8un6rbvsh4b","category_id":"cjd8gvpk40004l4unr5gx75gs","_id":"cjdo197tw0003l8unub2w9xeb"}],"PostTag":[{"post_id":"cjd8gvpjw0000l4unifjpnynz","tag_id":"cjd8gvpk20002l4un9zrrb3a3","_id":"cjd8gvpk60006l4unmsmwy7s5"},{"post_id":"cjd8gvpk00001l4und3mleixp","tag_id":"cjd8gvpk50005l4uni93zsuwf","_id":"cjd8gvpk9000al4un5i1v9406"},{"post_id":"cjd8gvpk00001l4und3mleixp","tag_id":"cjd8gvpk70007l4un5zbziwny","_id":"cjd8gvpk9000bl4univjkds80"},{"post_id":"cjd8gvpk30003l4unk6s2mlkw","tag_id":"cjd8gvpk20002l4un9zrrb3a3","_id":"cjd8gvpk9000cl4unr0ulxipt"},{"post_id":"cjdmw73ep0000lsunohqe2x06","tag_id":"cjd8gvpk50005l4uni93zsuwf","_id":"cjdmw73eu0001lsun17hbmfht"},{"post_id":"cjdmw73ep0000lsunohqe2x06","tag_id":"cjd8gvpk70007l4un5zbziwny","_id":"cjdmw73ev0002lsuniazfsojl"},{"post_id":"cjdo197tp0000l8un6rbvsh4b","tag_id":"cjd8gvpk50005l4uni93zsuwf","_id":"cjdo197tv0001l8unbucli5ds"},{"post_id":"cjdo197tp0000l8un6rbvsh4b","tag_id":"cjd8gvpk70007l4un5zbziwny","_id":"cjdo197tw0002l8unxsv3et70"}],"Tag":[{"name":"Java","_id":"cjd8gvpk20002l4un9zrrb3a3"},{"name":"JavaScript","_id":"cjd8gvpk50005l4uni93zsuwf"},{"name":"D3","_id":"cjd8gvpk70007l4un5zbziwny"}]}}